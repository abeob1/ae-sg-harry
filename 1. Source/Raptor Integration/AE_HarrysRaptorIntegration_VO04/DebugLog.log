[07/25/2017 14:49:39][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 14:50:17][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 14:50:17][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 14:50:18][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 14:50:31][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 14:50:33][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 14:50:33][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 14:50:34][          ExecuteSQLQuery_DT()] Completed with ERROR
[07/25/2017 14:58:49][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 14:58:51][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 14:58:51][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 14:58:52][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 14:58:56][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 14:58:58][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 14:58:59][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 14:58:59][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 14:59:12][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/25/2017 14:59:13][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 14:59:14][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 14:59:14][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 14:59:44][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/25/2017 14:59:46][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 14:59:48][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 14:59:48][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 14:59:58][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/25/2017 15:00:05][                        Main()] Calling ConnectToTargetCompany()
[07/25/2017 15:00:06][      ConnectToTargetCompany()] Starting function
[07/25/2017 15:00:06][      ConnectToTargetCompany()] Initializing the Company Object
[07/25/2017 15:00:09][      ConnectToTargetCompany()] Assigning the representing database name
[07/25/2017 15:00:09][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/25/2017 15:00:10][      ConnectToTargetCompany()] Completed with ERROR
[07/25/2017 15:01:59][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 15:01:59][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:01:59][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:01:59][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:01:59][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 15:01:59][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:01:59][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:01:59][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:01:59][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/25/2017 15:01:59][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:01:59][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:01:59][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:01:59][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/25/2017 15:01:59][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:01:59][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:01:59][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:01:59][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/25/2017 15:02:04][                        Main()] Calling ConnectToTargetCompany()
[07/25/2017 15:02:09][      ConnectToTargetCompany()] Starting function
[07/25/2017 15:02:10][      ConnectToTargetCompany()] Initializing the Company Object
[07/25/2017 15:02:15][      ConnectToTargetCompany()] Assigning the representing database name
[07/25/2017 15:02:24][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/25/2017 15:03:36][      ConnectToTargetCompany()] Completed with SUCCESS
[07/25/2017 15:03:41][                        Main()] Calling IntegrityValidation()
[07/25/2017 15:03:51][         IntegrityValidation()] Starting Function
[07/25/2017 15:05:04][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/25/2017 15:09:38][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 15:09:38][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:09:38][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:09:38][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:09:38][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 15:09:38][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:09:38][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:09:38][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:09:38][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/25/2017 15:09:38][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:09:38][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:09:38][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:09:38][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/25/2017 15:09:38][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:09:38][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:09:38][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:09:38][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/25/2017 15:10:23][                        Main()] Calling ConnectToTargetCompany()
[07/25/2017 15:10:24][      ConnectToTargetCompany()] Starting function
[07/25/2017 15:10:24][      ConnectToTargetCompany()] Initializing the Company Object
[07/25/2017 15:10:28][      ConnectToTargetCompany()] Assigning the representing database name
[07/25/2017 15:10:28][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/25/2017 15:10:40][      ConnectToTargetCompany()] Completed with SUCCESS
[07/25/2017 15:11:09][                        Main()] Calling IntegrityValidation()
[07/25/2017 15:11:10][         IntegrityValidation()] Starting Function
[07/25/2017 15:11:17][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/25/2017 15:11:50][         IntegrityValidation()] Validation Update SQL UPDATE [AB_SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[ErrorMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC180717199010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC180717199010101' 
[07/25/2017 15:11:52][         IntegrityValidation()] Calling Function ExecuteSQLQuery_DT() 
[07/25/2017 15:11:53][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:11:53][          ExecuteSQLQuery_DT()] Completed with ERROR
[07/25/2017 15:15:59][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 15:15:59][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:15:59][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:15:59][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:15:59][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 15:15:59][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:15:59][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:15:59][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:15:59][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/25/2017 15:15:59][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:15:59][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:15:59][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:15:59][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/25/2017 15:15:59][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:15:59][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:15:59][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:15:59][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/25/2017 15:16:03][                        Main()] Calling ConnectToTargetCompany()
[07/25/2017 15:16:04][      ConnectToTargetCompany()] Starting function
[07/25/2017 15:16:04][      ConnectToTargetCompany()] Initializing the Company Object
[07/25/2017 15:16:08][      ConnectToTargetCompany()] Assigning the representing database name
[07/25/2017 15:16:08][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/25/2017 15:16:20][      ConnectToTargetCompany()] Completed with SUCCESS
[07/25/2017 15:20:00][                        Main()] Calling IntegrityValidation()
[07/25/2017 15:20:00][         IntegrityValidation()] Starting Function
[07/25/2017 15:20:05][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/25/2017 15:20:37][         IntegrityValidation()] Validation Update SQL UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[ErrorMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC180717199010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC180717199010101' 
[07/25/2017 15:20:38][         IntegrityValidation()] Calling Function ExecuteSQLQuery_DT() 
[07/25/2017 15:20:40][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:20:40][          ExecuteSQLQuery_DT()] Completed with ERROR
[07/25/2017 15:32:29][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 15:32:29][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:32:29][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:32:29][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:32:29][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 15:32:29][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:32:29][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:32:29][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:32:29][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/25/2017 15:32:29][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:32:29][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:32:30][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:32:30][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/25/2017 15:32:30][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:32:30][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:32:30][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:32:30][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/25/2017 15:32:33][                        Main()] Calling ConnectToTargetCompany()
[07/25/2017 15:32:33][      ConnectToTargetCompany()] Starting function
[07/25/2017 15:32:33][      ConnectToTargetCompany()] Initializing the Company Object
[07/25/2017 15:32:37][      ConnectToTargetCompany()] Assigning the representing database name
[07/25/2017 15:32:37][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/25/2017 15:32:49][      ConnectToTargetCompany()] Completed with SUCCESS
[07/25/2017 15:32:52][                        Main()] Calling IntegrityValidation()
[07/25/2017 15:32:53][         IntegrityValidation()] Starting Function
[07/25/2017 15:32:58][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/25/2017 15:33:38][         IntegrityValidation()] Validation Update SQL UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = ',SG10000001,SG10000002,SG10000002,SG10000002,SG10000003,SG10000003,SG10000004,SG10000005,SG10000007,SG10000008,SG10000008,SG10000008,SG10000008,SG10000008,SG10000008,SG10000008,SG10000009,SG10000009,SG10000010,SG10000010,SG10000011,SG10000012,SG10000014,SG10000015,SG10000016,SG10000016,SG10000018,SG10000019,SG10000021,SG10000024,SG10000025,SG10000025,SG10000028,SG10000028,SG10000029,SG10000031 - Item Codes not mapped in SAP B1 for File ID 11JKC180717199010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC180717199010101' 
[07/25/2017 15:33:39][         IntegrityValidation()] Calling Function ExecuteSQLQuery_DT() 
[07/25/2017 15:34:00][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:34:00][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:34:04][         IntegrityValidation()] Completed with SUCCESS 
[07/25/2017 15:34:04][                        Main()] Completed with SUCCESS
[07/25/2017 15:38:08][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 15:38:08][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:38:08][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:38:08][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:38:08][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 15:38:08][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:38:08][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:38:08][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:38:08][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/25/2017 15:38:08][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:38:08][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:38:08][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:38:08][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/25/2017 15:38:08][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:38:08][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:38:08][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:38:08][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/25/2017 15:38:11][                        Main()] Calling ConnectToTargetCompany()
[07/25/2017 15:38:12][      ConnectToTargetCompany()] Starting function
[07/25/2017 15:38:12][      ConnectToTargetCompany()] Initializing the Company Object
[07/25/2017 15:38:15][      ConnectToTargetCompany()] Assigning the representing database name
[07/25/2017 15:38:15][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/25/2017 15:38:16][      ConnectToTargetCompany()] Completed with ERROR
[07/25/2017 15:39:08][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 15:39:08][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:39:08][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:39:08][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:39:08][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 15:39:08][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:39:08][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:39:08][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:39:08][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/25/2017 15:39:08][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:39:08][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:39:08][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:39:08][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/25/2017 15:39:08][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:39:08][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:39:08][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:39:08][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/25/2017 15:39:11][                        Main()] Calling ConnectToTargetCompany()
[07/25/2017 15:39:12][      ConnectToTargetCompany()] Starting function
[07/25/2017 15:39:12][      ConnectToTargetCompany()] Initializing the Company Object
[07/25/2017 15:39:15][      ConnectToTargetCompany()] Assigning the representing database name
[07/25/2017 15:39:15][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/25/2017 15:39:28][      ConnectToTargetCompany()] Completed with SUCCESS
[07/25/2017 15:39:31][                        Main()] Calling IntegrityValidation()
[07/25/2017 15:39:32][         IntegrityValidation()] Starting Function
[07/25/2017 15:39:38][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/25/2017 15:42:18][     MarketingDocuments_Sync()] Starting Function 
[07/25/2017 15:45:33][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 15:45:33][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:45:33][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:45:33][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:45:33][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 15:45:33][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:45:33][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:45:33][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:45:33][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/25/2017 15:45:33][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:45:33][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:45:33][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:45:33][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/25/2017 15:45:33][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:45:33][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:45:33][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:45:33][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/25/2017 15:45:37][                        Main()] Calling ConnectToTargetCompany()
[07/25/2017 15:45:37][      ConnectToTargetCompany()] Starting function
[07/25/2017 15:45:37][      ConnectToTargetCompany()] Initializing the Company Object
[07/25/2017 15:45:40][      ConnectToTargetCompany()] Assigning the representing database name
[07/25/2017 15:45:40][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/25/2017 15:45:52][      ConnectToTargetCompany()] Completed with SUCCESS
[07/25/2017 15:45:52][                        Main()] Calling IntegrityValidation()
[07/25/2017 15:45:52][         IntegrityValidation()] Starting Function
[07/25/2017 15:46:00][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/25/2017 15:46:18][     MarketingDocuments_Sync()] Starting Function 
[07/25/2017 15:49:29][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 15:49:29][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:49:29][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:49:29][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:49:29][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 15:49:29][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:49:29][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:49:29][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:49:29][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/25/2017 15:49:29][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:49:29][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:49:29][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:49:29][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/25/2017 15:49:29][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 15:49:29][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 15:49:29][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 15:49:29][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/25/2017 15:49:29][                        Main()] Calling ConnectToTargetCompany()
[07/25/2017 15:49:29][      ConnectToTargetCompany()] Starting function
[07/25/2017 15:49:29][      ConnectToTargetCompany()] Initializing the Company Object
[07/25/2017 15:49:33][      ConnectToTargetCompany()] Assigning the representing database name
[07/25/2017 15:49:33][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/25/2017 15:49:44][      ConnectToTargetCompany()] Completed with SUCCESS
[07/25/2017 15:49:44][                        Main()] Calling IntegrityValidation()
[07/25/2017 15:49:44][         IntegrityValidation()] Starting Function
[07/25/2017 15:49:44][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/25/2017 15:50:46][     MarketingDocuments_Sync()] Starting Function 
[07/25/2017 15:51:04][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/25/2017 15:51:44][          AR_InvoiceCreation()] Starting Function 
[07/25/2017 18:06:51][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 18:06:51][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 18:06:51][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 18:06:51][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 18:06:51][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 18:06:51][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 18:06:51][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 18:06:51][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 18:06:51][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/25/2017 18:06:51][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 18:06:51][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 18:06:51][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 18:06:51][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/25/2017 18:06:51][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 18:06:51][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 18:06:51][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 18:06:51][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/25/2017 18:06:51][                        Main()] Calling ConnectToTargetCompany()
[07/25/2017 18:06:51][      ConnectToTargetCompany()] Starting function
[07/25/2017 18:06:51][      ConnectToTargetCompany()] Initializing the Company Object
[07/25/2017 18:06:55][      ConnectToTargetCompany()] Assigning the representing database name
[07/25/2017 18:06:55][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/25/2017 18:07:07][      ConnectToTargetCompany()] Completed with SUCCESS
[07/25/2017 18:07:07][                        Main()] Calling IntegrityValidation()
[07/25/2017 18:07:07][         IntegrityValidation()] Starting Function
[07/25/2017 18:07:07][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/25/2017 18:07:14][     MarketingDocuments_Sync()] Starting Function 
[07/25/2017 18:07:27][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/25/2017 18:07:45][          AR_InvoiceCreation()] Starting Function 
[07/25/2017 18:10:25][          AR_InvoiceCreation()] Completed with ERROR
[07/25/2017 18:10:25][          AR_InvoiceCreation()] Rollback the SAP Transaction 
[07/25/2017 18:10:25][     MarketingDocuments_Sync()] Completed with ERROR
[07/25/2017 18:10:25][     MarketingDocuments_Sync()] Rollback the SAP Transaction 
[07/25/2017 18:10:25][         IntegrityValidation()] Completed with SUCCESS 
[07/25/2017 18:10:25][                        Main()] Completed with SUCCESS
[07/25/2017 18:16:02][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 18:16:02][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 18:16:02][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 18:16:02][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 18:16:02][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 18:16:02][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 18:16:02][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 18:16:02][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 18:16:02][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/25/2017 18:16:02][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 18:16:02][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 18:16:02][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 18:16:02][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/25/2017 18:16:02][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 18:16:02][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 18:16:02][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 18:16:02][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/25/2017 18:16:02][                        Main()] Calling ConnectToTargetCompany()
[07/25/2017 18:16:02][      ConnectToTargetCompany()] Starting function
[07/25/2017 18:16:02][      ConnectToTargetCompany()] Initializing the Company Object
[07/25/2017 18:16:05][      ConnectToTargetCompany()] Assigning the representing database name
[07/25/2017 18:16:05][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/25/2017 18:16:17][      ConnectToTargetCompany()] Completed with SUCCESS
[07/25/2017 18:16:17][                        Main()] Calling IntegrityValidation()
[07/25/2017 18:16:17][         IntegrityValidation()] Starting Function
[07/25/2017 18:16:17][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/25/2017 18:16:22][     MarketingDocuments_Sync()] Starting Function 
[07/25/2017 18:16:22][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/25/2017 18:16:25][          AR_InvoiceCreation()] Starting Function 
[07/25/2017 18:17:13][          AR_InvoiceCreation()] Completed with ERROR
[07/25/2017 18:17:14][          AR_InvoiceCreation()] Rollback the SAP Transaction 
[07/25/2017 18:17:20][     MarketingDocuments_Sync()] Completed with ERROR
[07/25/2017 18:17:21][     MarketingDocuments_Sync()] Rollback the SAP Transaction 
[07/25/2017 18:17:24][         IntegrityValidation()] Completed with SUCCESS 
[07/25/2017 18:18:13][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 18:18:13][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 18:18:13][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 18:18:13][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 18:18:13][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 18:18:13][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 18:18:13][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 18:18:13][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 18:18:13][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/25/2017 18:18:13][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 18:18:13][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 18:18:13][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 18:18:13][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/25/2017 18:18:13][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 18:18:13][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 18:18:13][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 18:18:13][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/25/2017 18:18:13][                        Main()] Calling ConnectToTargetCompany()
[07/25/2017 18:18:13][      ConnectToTargetCompany()] Starting function
[07/25/2017 18:18:13][      ConnectToTargetCompany()] Initializing the Company Object
[07/25/2017 18:18:16][      ConnectToTargetCompany()] Assigning the representing database name
[07/25/2017 18:18:16][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/25/2017 18:18:31][      ConnectToTargetCompany()] Completed with ERROR
[07/25/2017 18:18:31][                        Main()] Completed with ERROR
[07/25/2017 18:18:45][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 18:18:45][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 18:18:45][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 18:18:46][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 18:18:46][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 18:18:46][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 18:18:46][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 18:18:46][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 18:18:46][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/25/2017 18:18:46][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 18:18:46][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 18:18:46][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 18:18:46][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/25/2017 18:18:46][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 18:18:46][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 18:18:46][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 18:18:46][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/25/2017 18:18:46][                        Main()] Calling ConnectToTargetCompany()
[07/25/2017 18:18:46][      ConnectToTargetCompany()] Starting function
[07/25/2017 18:18:46][      ConnectToTargetCompany()] Initializing the Company Object
[07/25/2017 18:18:49][      ConnectToTargetCompany()] Assigning the representing database name
[07/25/2017 18:18:49][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/25/2017 18:19:02][      ConnectToTargetCompany()] Completed with SUCCESS
[07/25/2017 18:19:02][                        Main()] Calling IntegrityValidation()
[07/25/2017 18:19:02][         IntegrityValidation()] Starting Function
[07/25/2017 18:19:02][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/25/2017 18:19:02][     MarketingDocuments_Sync()] Starting Function 
[07/25/2017 18:19:02][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/25/2017 18:19:14][          AR_InvoiceCreation()] Starting Function 
[07/25/2017 18:19:38][     MarketingDocuments_Sync()] Rollback the SAP Transaction 
[07/25/2017 18:19:48][     MarketingDocuments_Sync()] Date Time 7/25/2017 6:19 PM
[07/25/2017 18:19:56][     MarketingDocuments_Sync()] Validation Update SQL UPDATE HarrysSAPINTDB.. [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'No matching records found in OWHS table 11JKC' , [ERRDateTime] =  DATEADD(day,datediff(day,0,GETDATE()),0) ,[SAPSyncDateTime] = GETDATE() WHERE [FileID] = '11JKC180717199010101'
[07/25/2017 18:19:57][     MarketingDocuments_Sync()] Executing Query
[07/25/2017 18:20:50][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 18:20:50][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 18:20:50][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 18:20:50][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 18:20:50][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 18:20:50][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 18:20:50][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 18:20:50][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 18:20:50][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/25/2017 18:20:50][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 18:20:50][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 18:20:50][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 18:20:50][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/25/2017 18:20:50][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 18:20:50][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 18:20:50][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 18:20:50][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/25/2017 18:20:50][                        Main()] Calling ConnectToTargetCompany()
[07/25/2017 18:20:50][      ConnectToTargetCompany()] Starting function
[07/25/2017 18:20:50][      ConnectToTargetCompany()] Initializing the Company Object
[07/25/2017 18:20:53][      ConnectToTargetCompany()] Assigning the representing database name
[07/25/2017 18:20:53][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/25/2017 18:21:06][      ConnectToTargetCompany()] Completed with SUCCESS
[07/25/2017 18:21:06][                        Main()] Calling IntegrityValidation()
[07/25/2017 18:21:06][         IntegrityValidation()] Starting Function
[07/25/2017 18:21:06][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/25/2017 18:21:06][     MarketingDocuments_Sync()] Starting Function 
[07/25/2017 18:21:06][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/25/2017 18:21:08][          AR_InvoiceCreation()] Starting Function 
[07/25/2017 18:21:12][     MarketingDocuments_Sync()] Rollback the SAP Transaction 
[07/25/2017 18:21:17][     MarketingDocuments_Sync()] Date Time 7/25/2017 6:21 PM
[07/25/2017 18:21:22][     MarketingDocuments_Sync()] Validation Update SQL UPDATE HarrysSAPINTDB.. [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'No matching records found in OWHS table 11JKC' , [ERRDateTime] =  DATEADD(day,datediff(day,0,GETDATE()),0)  WHERE [FileID] = '11JKC180717199010101'
[07/25/2017 18:21:23][     MarketingDocuments_Sync()] Executing Query
[07/25/2017 18:27:27][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 18:27:27][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 18:27:27][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 18:27:27][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 18:27:27][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 18:27:27][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 18:27:27][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 18:27:27][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 18:27:27][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/25/2017 18:27:27][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 18:27:27][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 18:27:27][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 18:27:27][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/25/2017 18:27:27][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 18:27:27][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 18:27:27][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 18:27:27][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/25/2017 18:27:27][                        Main()] Calling ConnectToTargetCompany()
[07/25/2017 18:27:27][      ConnectToTargetCompany()] Starting function
[07/25/2017 18:27:27][      ConnectToTargetCompany()] Initializing the Company Object
[07/25/2017 18:27:31][      ConnectToTargetCompany()] Assigning the representing database name
[07/25/2017 18:27:31][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/25/2017 18:27:43][      ConnectToTargetCompany()] Completed with SUCCESS
[07/25/2017 18:27:43][                        Main()] Calling IntegrityValidation()
[07/25/2017 18:27:43][         IntegrityValidation()] Starting Function
[07/25/2017 18:27:43][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/25/2017 18:27:43][     MarketingDocuments_Sync()] Starting Function 
[07/25/2017 18:27:43][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/25/2017 18:27:59][          AR_InvoiceCreation()] Starting Function 
[07/25/2017 18:30:40][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/25/2017 18:30:52][          AR_InvoiceCreation()] Completed with ERROR 
[07/25/2017 18:31:07][     MarketingDocuments_Sync()] Rollback the SAP Transaction 
[07/25/2017 18:31:11][     MarketingDocuments_Sync()] Date Time 7/25/2017 6:31 PM
[07/25/2017 18:31:17][     MarketingDocuments_Sync()] Validation Update SQL UPDATE HarrysSAPINTDB.. [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Invalid BP code  [ODRF.CardCode] , ''CASH''' , [ERRDateTime] =  DATEADD(day,datediff(day,0,GETDATE()),0)  WHERE [FileID] = '11JKC180717199010101'
[07/25/2017 18:31:18][     MarketingDocuments_Sync()] Executing Query
[07/25/2017 18:31:22][     MarketingDocuments_Sync()] Committed the Transaction Reference File ID : 11JKC180717199010101
[07/25/2017 18:31:22][         IntegrityValidation()] Completed with SUCCESS 
[07/25/2017 18:31:22][                        Main()] Completed with SUCCESS
[07/25/2017 19:07:25][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 19:07:25][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:07:25][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:07:26][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:07:26][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 19:07:26][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:07:26][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:07:26][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:07:26][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/25/2017 19:07:26][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:07:26][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:07:26][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:07:26][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/25/2017 19:07:26][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:07:26][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:07:26][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:07:26][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/25/2017 19:07:26][                        Main()] Calling ConnectToTargetCompany()
[07/25/2017 19:07:26][      ConnectToTargetCompany()] Starting function
[07/25/2017 19:07:26][      ConnectToTargetCompany()] Initializing the Company Object
[07/25/2017 19:07:29][      ConnectToTargetCompany()] Assigning the representing database name
[07/25/2017 19:07:29][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/25/2017 19:07:41][      ConnectToTargetCompany()] Completed with SUCCESS
[07/25/2017 19:07:41][                        Main()] Calling IntegrityValidation()
[07/25/2017 19:07:41][         IntegrityValidation()] Starting Function
[07/25/2017 19:07:41][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/25/2017 19:07:41][     MarketingDocuments_Sync()] Starting Function 
[07/25/2017 19:07:41][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/25/2017 19:08:05][          AR_InvoiceCreation()] Starting Function 
[07/25/2017 19:08:42][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/25/2017 19:12:15][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 19:12:15][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:12:15][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:12:16][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:12:16][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 19:12:16][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:12:16][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:12:16][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:12:16][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/25/2017 19:12:16][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:12:16][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:12:16][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:12:16][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/25/2017 19:12:16][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:12:16][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:12:16][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:12:16][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/25/2017 19:12:16][                        Main()] Calling ConnectToTargetCompany()
[07/25/2017 19:12:16][      ConnectToTargetCompany()] Starting function
[07/25/2017 19:12:16][      ConnectToTargetCompany()] Initializing the Company Object
[07/25/2017 19:12:19][      ConnectToTargetCompany()] Assigning the representing database name
[07/25/2017 19:12:19][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/25/2017 19:12:32][      ConnectToTargetCompany()] Completed with SUCCESS
[07/25/2017 19:12:32][                        Main()] Calling IntegrityValidation()
[07/25/2017 19:12:32][         IntegrityValidation()] Starting Function
[07/25/2017 19:12:32][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/25/2017 19:12:32][     MarketingDocuments_Sync()] Starting Function 
[07/25/2017 19:12:32][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/25/2017 19:13:46][          AR_InvoiceCreation()] Starting Function 
[07/25/2017 19:13:58][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/25/2017 19:16:09][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 19:16:09][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:16:09][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:16:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:16:09][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 19:16:09][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:16:09][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:16:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:16:09][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/25/2017 19:16:09][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:16:09][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:16:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:16:09][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/25/2017 19:16:09][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:16:09][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:16:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:16:09][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/25/2017 19:16:09][                        Main()] Calling ConnectToTargetCompany()
[07/25/2017 19:16:09][      ConnectToTargetCompany()] Starting function
[07/25/2017 19:16:09][      ConnectToTargetCompany()] Initializing the Company Object
[07/25/2017 19:16:12][      ConnectToTargetCompany()] Assigning the representing database name
[07/25/2017 19:16:12][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/25/2017 19:16:25][      ConnectToTargetCompany()] Completed with SUCCESS
[07/25/2017 19:16:25][                        Main()] Calling IntegrityValidation()
[07/25/2017 19:16:25][         IntegrityValidation()] Starting Function
[07/25/2017 19:16:25][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/25/2017 19:16:25][     MarketingDocuments_Sync()] Starting Function 
[07/25/2017 19:16:25][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/25/2017 19:16:37][          AR_InvoiceCreation()] Starting Function 
[07/25/2017 19:16:47][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/25/2017 19:48:20][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 19:48:20][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:48:20][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:48:20][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:48:20][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 19:48:20][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:48:20][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:48:20][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:48:20][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/25/2017 19:48:20][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:48:20][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:48:20][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:48:20][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/25/2017 19:48:20][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:48:20][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:48:20][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:48:20][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/25/2017 19:48:20][                        Main()] Calling ConnectToTargetCompany()
[07/25/2017 19:48:20][      ConnectToTargetCompany()] Starting function
[07/25/2017 19:48:20][      ConnectToTargetCompany()] Initializing the Company Object
[07/25/2017 19:48:23][      ConnectToTargetCompany()] Assigning the representing database name
[07/25/2017 19:48:23][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/25/2017 19:48:36][      ConnectToTargetCompany()] Completed with SUCCESS
[07/25/2017 19:48:36][                        Main()] Calling IntegrityValidation()
[07/25/2017 19:48:36][         IntegrityValidation()] Starting Function
[07/25/2017 19:48:36][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/25/2017 19:48:36][     MarketingDocuments_Sync()] Starting Function 
[07/25/2017 19:48:36][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/25/2017 19:48:40][          AR_InvoiceCreation()] Starting Function 
[07/25/2017 19:50:01][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/25/2017 19:51:27][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 19:51:27][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:51:27][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:51:28][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:51:28][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 19:51:28][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:51:28][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:51:28][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:51:28][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/25/2017 19:51:28][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:51:28][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:51:28][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:51:28][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/25/2017 19:51:28][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:51:28][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:51:28][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:51:28][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/25/2017 19:51:28][                        Main()] Calling ConnectToTargetCompany()
[07/25/2017 19:51:28][      ConnectToTargetCompany()] Starting function
[07/25/2017 19:51:28][      ConnectToTargetCompany()] Initializing the Company Object
[07/25/2017 19:51:31][      ConnectToTargetCompany()] Assigning the representing database name
[07/25/2017 19:51:31][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/25/2017 19:51:43][      ConnectToTargetCompany()] Completed with SUCCESS
[07/25/2017 19:51:43][                        Main()] Calling IntegrityValidation()
[07/25/2017 19:51:43][         IntegrityValidation()] Starting Function
[07/25/2017 19:51:43][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/25/2017 19:51:43][     MarketingDocuments_Sync()] Starting Function 
[07/25/2017 19:51:43][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/25/2017 19:51:46][          AR_InvoiceCreation()] Starting Function 
[07/25/2017 19:52:13][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/25/2017 19:55:03][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 19:55:03][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:55:03][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:55:03][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:55:03][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 19:55:03][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:55:03][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:55:04][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:55:04][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/25/2017 19:55:04][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:55:04][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:55:04][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:55:04][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/25/2017 19:55:04][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:55:04][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:55:04][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:55:04][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/25/2017 19:55:04][                        Main()] Calling ConnectToTargetCompany()
[07/25/2017 19:55:04][      ConnectToTargetCompany()] Starting function
[07/25/2017 19:55:04][      ConnectToTargetCompany()] Initializing the Company Object
[07/25/2017 19:55:07][      ConnectToTargetCompany()] Assigning the representing database name
[07/25/2017 19:55:07][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/25/2017 19:55:19][      ConnectToTargetCompany()] Completed with SUCCESS
[07/25/2017 19:55:19][                        Main()] Calling IntegrityValidation()
[07/25/2017 19:55:19][         IntegrityValidation()] Starting Function
[07/25/2017 19:55:19][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/25/2017 19:55:19][     MarketingDocuments_Sync()] Starting Function 
[07/25/2017 19:55:19][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/25/2017 19:55:23][          AR_InvoiceCreation()] Starting Function 
[07/25/2017 19:58:01][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 19:58:01][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:58:01][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:58:01][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:58:01][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 19:58:01][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:58:01][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:58:01][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:58:01][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/25/2017 19:58:01][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:58:01][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:58:01][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:58:01][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/25/2017 19:58:01][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 19:58:01][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 19:58:01][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 19:58:01][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/25/2017 19:58:01][                        Main()] Calling ConnectToTargetCompany()
[07/25/2017 19:58:01][      ConnectToTargetCompany()] Starting function
[07/25/2017 19:58:01][      ConnectToTargetCompany()] Initializing the Company Object
[07/25/2017 19:58:04][      ConnectToTargetCompany()] Assigning the representing database name
[07/25/2017 19:58:04][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/25/2017 19:58:16][      ConnectToTargetCompany()] Completed with SUCCESS
[07/25/2017 19:58:16][                        Main()] Calling IntegrityValidation()
[07/25/2017 19:58:16][         IntegrityValidation()] Starting Function
[07/25/2017 19:58:16][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/25/2017 19:58:16][     MarketingDocuments_Sync()] Starting Function 
[07/25/2017 19:58:16][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/25/2017 19:58:22][          AR_InvoiceCreation()] Starting Function 
[07/25/2017 19:58:59][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/25/2017 20:09:54][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 20:09:54][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 20:09:54][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 20:09:54][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 20:09:54][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 20:09:54][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 20:09:54][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 20:09:54][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 20:09:54][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/25/2017 20:09:54][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 20:09:54][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 20:09:54][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 20:09:54][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/25/2017 20:09:54][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 20:09:54][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 20:09:54][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 20:09:54][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/25/2017 20:09:54][                        Main()] Calling ConnectToTargetCompany()
[07/25/2017 20:09:54][      ConnectToTargetCompany()] Starting function
[07/25/2017 20:09:54][      ConnectToTargetCompany()] Initializing the Company Object
[07/25/2017 20:09:58][      ConnectToTargetCompany()] Assigning the representing database name
[07/25/2017 20:09:58][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/25/2017 20:10:11][      ConnectToTargetCompany()] Completed with SUCCESS
[07/25/2017 20:10:11][                        Main()] Calling IntegrityValidation()
[07/25/2017 20:10:11][         IntegrityValidation()] Starting Function
[07/25/2017 20:10:11][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/25/2017 20:10:11][     MarketingDocuments_Sync()] Starting Function 
[07/25/2017 20:10:11][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/25/2017 20:10:15][          AR_InvoiceCreation()] Starting Function 
[07/25/2017 20:10:28][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/25/2017 20:12:04][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/25/2017 20:12:04][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 20:12:04][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 20:12:04][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 20:12:04][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/25/2017 20:12:04][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 20:12:04][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 20:12:04][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 20:12:04][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/25/2017 20:12:04][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 20:12:04][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 20:12:04][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 20:12:04][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/25/2017 20:12:04][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/25/2017 20:12:04][          ExecuteSQLQuery_DT()] Starting function
[07/25/2017 20:12:04][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/25/2017 20:12:04][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/25/2017 20:12:04][                        Main()] Calling ConnectToTargetCompany()
[07/25/2017 20:12:04][      ConnectToTargetCompany()] Starting function
[07/25/2017 20:12:04][      ConnectToTargetCompany()] Initializing the Company Object
[07/25/2017 20:12:07][      ConnectToTargetCompany()] Assigning the representing database name
[07/25/2017 20:12:07][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/25/2017 20:12:19][      ConnectToTargetCompany()] Completed with SUCCESS
[07/25/2017 20:12:19][                        Main()] Calling IntegrityValidation()
[07/25/2017 20:12:19][         IntegrityValidation()] Starting Function
[07/25/2017 20:12:19][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/25/2017 20:12:19][     MarketingDocuments_Sync()] Starting Function 
[07/25/2017 20:12:19][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/25/2017 20:12:22][          AR_InvoiceCreation()] Starting Function 
[07/25/2017 20:12:36][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/26/2017 02:03:27][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/26/2017 02:03:27][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 02:03:27][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 02:03:28][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 02:03:28][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/26/2017 02:03:28][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 02:03:28][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 02:03:28][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 02:03:28][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/26/2017 02:03:28][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 02:03:28][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 02:03:28][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 02:03:28][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/26/2017 02:03:28][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 02:03:28][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 02:03:28][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 02:03:28][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/26/2017 02:03:28][                        Main()] Calling ConnectToTargetCompany()
[07/26/2017 02:03:28][      ConnectToTargetCompany()] Starting function
[07/26/2017 02:03:28][      ConnectToTargetCompany()] Initializing the Company Object
[07/26/2017 02:03:31][      ConnectToTargetCompany()] Assigning the representing database name
[07/26/2017 02:03:31][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/26/2017 02:03:43][      ConnectToTargetCompany()] Completed with SUCCESS
[07/26/2017 02:03:43][                        Main()] Calling IntegrityValidation()
[07/26/2017 02:03:43][         IntegrityValidation()] Starting Function
[07/26/2017 02:03:43][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/26/2017 02:03:43][     MarketingDocuments_Sync()] Starting Function 
[07/26/2017 02:03:43][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/26/2017 02:03:48][          AR_InvoiceCreation()] Starting Function 
[07/26/2017 02:04:15][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/26/2017 02:04:32][          AR_InvoiceCreation()] Draft Added Successfully  83
[07/26/2017 02:04:40][          AR_InvoiceCreation()] Draft Details SQL SELECT T0.[LineNum], T0.[ItemCode], T0.[Quantity], T0.[WhsCode], T1.[ManBtchNum] FROM DRF1 T0 WITH (NOLOCK) INNER JOIN OITM T1 WITH (NOLOCK) ON T0.[ItemCode] = T1.[ItemCode] WHERE T0.[DocEntry] = '83'
[07/26/2017 02:06:05][                Update_Draft()] Starting function
[07/26/2017 02:06:06][                Update_Draft()] Executing the Query, Query String : select T0.[ItemCode],T0.[Project],T0.[CogsAcct],T0.[WhsCode],T0.[LineNum],T0.[TreeType] from DRF1 T0 where DocEntry='83'
[07/26/2017 02:06:10][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:06:11][            ConvertRecordset()] Starting function
[07/26/2017 02:06:11][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:06:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000001' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:06:42][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:06:43][            ConvertRecordset()] Starting function
[07/26/2017 02:06:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:06:59][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000002' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:00][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:00][            ConvertRecordset()] Starting function
[07/26/2017 02:07:00][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:05][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:06][            ConvertRecordset()] Starting function
[07/26/2017 02:07:06][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:09][            ConvertRecordset()] Starting function
[07/26/2017 02:07:09][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:11][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:12][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:12][            ConvertRecordset()] Starting function
[07/26/2017 02:07:12][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:16][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000003' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:18][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:18][            ConvertRecordset()] Starting function
[07/26/2017 02:07:18][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:28][            ConvertRecordset()] Starting function
[07/26/2017 02:07:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:28][            ConvertRecordset()] Starting function
[07/26/2017 02:07:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000005' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:28][            ConvertRecordset()] Starting function
[07/26/2017 02:07:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000007' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:28][            ConvertRecordset()] Starting function
[07/26/2017 02:07:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:28][            ConvertRecordset()] Starting function
[07/26/2017 02:07:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000008' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:28][            ConvertRecordset()] Starting function
[07/26/2017 02:07:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:28][            ConvertRecordset()] Starting function
[07/26/2017 02:07:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:28][            ConvertRecordset()] Starting function
[07/26/2017 02:07:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000009' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:28][            ConvertRecordset()] Starting function
[07/26/2017 02:07:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000010' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:28][            ConvertRecordset()] Starting function
[07/26/2017 02:07:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000011' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:29][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:29][            ConvertRecordset()] Starting function
[07/26/2017 02:07:29][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:29][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000012' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:29][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:29][            ConvertRecordset()] Starting function
[07/26/2017 02:07:29][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:29][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000014' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:29][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:29][            ConvertRecordset()] Starting function
[07/26/2017 02:07:29][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:29][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000015' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:29][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:29][            ConvertRecordset()] Starting function
[07/26/2017 02:07:29][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:29][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000016' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:29][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:29][            ConvertRecordset()] Starting function
[07/26/2017 02:07:29][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:29][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:29][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:29][            ConvertRecordset()] Starting function
[07/26/2017 02:07:29][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:29][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000018' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:29][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:29][            ConvertRecordset()] Starting function
[07/26/2017 02:07:29][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:29][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000019' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:29][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:29][            ConvertRecordset()] Starting function
[07/26/2017 02:07:29][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:29][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000021' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:29][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:29][            ConvertRecordset()] Starting function
[07/26/2017 02:07:29][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:29][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000024' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:29][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:29][            ConvertRecordset()] Starting function
[07/26/2017 02:07:29][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:29][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:29][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:29][            ConvertRecordset()] Starting function
[07/26/2017 02:07:29][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:29][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000025' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:29][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:29][            ConvertRecordset()] Starting function
[07/26/2017 02:07:29][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:29][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:29][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:29][            ConvertRecordset()] Starting function
[07/26/2017 02:07:29][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:29][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:29][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:29][            ConvertRecordset()] Starting function
[07/26/2017 02:07:29][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:29][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000028' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:29][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:29][            ConvertRecordset()] Starting function
[07/26/2017 02:07:29][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:29][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000029' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:29][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:29][            ConvertRecordset()] Starting function
[07/26/2017 02:07:29][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:29][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000031' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:29][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:29][            ConvertRecordset()] Starting function
[07/26/2017 02:07:29][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:29][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'MISC0004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:07:29][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:07:29][            ConvertRecordset()] Starting function
[07/26/2017 02:07:29][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:07:32][                Update_Draft()] Before Update the Draft With Update Draft
[07/26/2017 02:07:42][                Update_Draft()] After Update the Draft. Return Value : 0
[07/26/2017 02:07:46][                Update_Draft()] Completed with SUCCESS
[07/26/2017 02:07:50][                Update_Draft()] Releasing the Objects
[07/26/2017 02:08:08][          AR_InvoiceCreation()] Completed with SUCCESS (Update AR Invoice Draft) 
[07/26/2017 02:08:11][          AR_InvoiceCreation()] Attempting to Convert as a AR Invoice Document 
[07/26/2017 02:12:02][          AR_InvoiceCreation()] Completed with ERROR
[07/26/2017 02:12:02][          AR_InvoiceCreation()] Rollback the SAP Transaction 
[07/26/2017 02:12:02][     MarketingDocuments_Sync()] Completed with ERROR
[07/26/2017 02:12:02][     MarketingDocuments_Sync()] Rollback the SAP Transaction 
[07/26/2017 02:12:02][         IntegrityValidation()] Completed with SUCCESS 
[07/26/2017 02:12:02][                        Main()] Completed with SUCCESS
[07/26/2017 02:16:09][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/26/2017 02:16:09][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 02:16:09][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 02:16:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 02:16:09][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/26/2017 02:16:09][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 02:16:09][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 02:16:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 02:16:09][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/26/2017 02:16:09][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 02:16:09][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 02:16:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 02:16:09][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/26/2017 02:16:09][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 02:16:09][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 02:16:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 02:16:09][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/26/2017 02:16:09][                        Main()] Calling ConnectToTargetCompany()
[07/26/2017 02:16:09][      ConnectToTargetCompany()] Starting function
[07/26/2017 02:16:09][      ConnectToTargetCompany()] Initializing the Company Object
[07/26/2017 02:16:12][      ConnectToTargetCompany()] Assigning the representing database name
[07/26/2017 02:16:12][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/26/2017 02:16:25][      ConnectToTargetCompany()] Completed with SUCCESS
[07/26/2017 02:16:25][                        Main()] Calling IntegrityValidation()
[07/26/2017 02:16:25][         IntegrityValidation()] Starting Function
[07/26/2017 02:16:25][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/26/2017 02:16:25][     MarketingDocuments_Sync()] Starting Function 
[07/26/2017 02:16:25][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/26/2017 02:16:25][          AR_InvoiceCreation()] Starting Function 
[07/26/2017 02:16:35][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/26/2017 02:16:57][          AR_InvoiceCreation()] Draft Added Successfully  83
[07/26/2017 02:16:57][          AR_InvoiceCreation()] Draft Details SQL SELECT T0.[LineNum], T0.[ItemCode], T0.[Quantity], T0.[WhsCode], T1.[ManBtchNum] FROM DRF1 T0 WITH (NOLOCK) INNER JOIN OITM T1 WITH (NOLOCK) ON T0.[ItemCode] = T1.[ItemCode] WHERE T0.[DocEntry] = '83'
[07/26/2017 02:17:05][          AR_InvoiceCreation()] Updating COGS Account  83
[07/26/2017 02:17:14][                Update_Draft()] Starting function
[07/26/2017 02:17:17][                Update_Draft()] Executing the Query, Query String : select T0.[ItemCode],T0.[Project],T0.[CogsAcct],T0.[WhsCode],T0.[LineNum],T0.[TreeType] from DRF1 T0 where DocEntry='83'
[07/26/2017 02:17:20][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:17:21][            ConvertRecordset()] Starting function
[07/26/2017 02:17:21][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:17:50][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000001' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:17:53][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:17:55][            ConvertRecordset()] Starting function
[07/26/2017 02:17:55][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:31][            ConvertRecordset()] Starting function
[07/26/2017 02:18:31][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:42][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:42][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:42][            ConvertRecordset()] Starting function
[07/26/2017 02:18:42][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:42][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:42][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:42][            ConvertRecordset()] Starting function
[07/26/2017 02:18:42][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:42][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000003' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:42][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:42][            ConvertRecordset()] Starting function
[07/26/2017 02:18:42][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:42][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:42][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:42][            ConvertRecordset()] Starting function
[07/26/2017 02:18:42][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:42][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000005' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000007' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000008' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000009' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000010' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000011' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000012' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000014' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000015' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000016' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000018' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000019' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000021' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000024' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000025' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000028' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000029' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000031' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'MISC0004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:18:43][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:18:43][            ConvertRecordset()] Starting function
[07/26/2017 02:18:43][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:18:43][                Update_Draft()] Before Update the Draft With Update Draft
[07/26/2017 02:18:54][                Update_Draft()] After Update the Draft. Return Value : 0
[07/26/2017 02:19:00][                Update_Draft()] Completed with SUCCESS
[07/26/2017 02:19:04][                Update_Draft()] Releasing the Objects
[07/26/2017 02:19:12][          AR_InvoiceCreation()] Completed with SUCCESS (Update AR Invoice Draft) 
[07/26/2017 02:19:14][          AR_InvoiceCreation()] Attempting to Convert as a AR Invoice Document 
[07/26/2017 02:19:41][          AR_InvoiceCreation()] Exception Quantity falls into negative inventory  [INV1.ItemCode][line: 1]
[07/26/2017 02:19:46][          AR_InvoiceCreation()] Completed with ERROR (Convert as a AR Invoice Document) 
[07/26/2017 02:21:43][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/26/2017 02:21:43][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 02:21:43][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 02:21:44][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 02:21:44][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/26/2017 02:21:44][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 02:21:44][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 02:21:44][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 02:21:44][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/26/2017 02:21:44][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 02:21:44][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 02:21:44][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 02:21:44][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/26/2017 02:21:44][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 02:21:44][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 02:21:44][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 02:21:44][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/26/2017 02:21:44][                        Main()] Calling ConnectToTargetCompany()
[07/26/2017 02:21:44][      ConnectToTargetCompany()] Starting function
[07/26/2017 02:21:44][      ConnectToTargetCompany()] Initializing the Company Object
[07/26/2017 02:21:47][      ConnectToTargetCompany()] Assigning the representing database name
[07/26/2017 02:21:47][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/26/2017 02:21:59][      ConnectToTargetCompany()] Completed with SUCCESS
[07/26/2017 02:21:59][                        Main()] Calling IntegrityValidation()
[07/26/2017 02:21:59][         IntegrityValidation()] Starting Function
[07/26/2017 02:21:59][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/26/2017 02:21:59][     MarketingDocuments_Sync()] Starting Function 
[07/26/2017 02:21:59][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/26/2017 02:21:59][          AR_InvoiceCreation()] Starting Function 
[07/26/2017 02:22:21][          AR_InvoiceCreation()] Draft Added Successfully  83
[07/26/2017 02:22:21][          AR_InvoiceCreation()] Draft Details SQL SELECT T0.[LineNum], T0.[ItemCode], T0.[Quantity], T0.[WhsCode], T1.[ManBtchNum] FROM DRF1 T0 WITH (NOLOCK) INNER JOIN OITM T1 WITH (NOLOCK) ON T0.[ItemCode] = T1.[ItemCode] WHERE T0.[DocEntry] = '83'
[07/26/2017 02:22:32][          AR_InvoiceCreation()] Updating COGS Account  83
[07/26/2017 02:22:36][                Update_Draft()] Starting function
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String : select T0.[ItemCode],T0.[Project],T0.[CogsAcct],T0.[WhsCode],T0.[LineNum],T0.[TreeType] from DRF1 T0 where DocEntry='83'
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000001' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000003' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000005' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000007' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000008' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000009' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000010' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000011' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000012' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000014' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000015' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000016' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000018' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000019' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000021' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000024' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000025' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000028' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000029' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000031' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'MISC0004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 02:22:36][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 02:22:36][            ConvertRecordset()] Starting function
[07/26/2017 02:22:36][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 02:22:36][                Update_Draft()] Before Update the Draft With Update Draft
[07/26/2017 02:22:43][                Update_Draft()] After Update the Draft. Return Value : 0
[07/26/2017 02:22:46][                Update_Draft()] Completed with SUCCESS
[07/26/2017 02:22:49][                Update_Draft()] Releasing the Objects
[07/26/2017 09:45:07][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/26/2017 09:45:07][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 09:45:07][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 09:45:07][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 09:45:07][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/26/2017 09:45:07][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 09:45:07][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 09:45:07][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 09:45:07][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/26/2017 09:45:07][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 09:45:07][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 09:45:07][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 09:45:07][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/26/2017 09:45:07][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 09:45:07][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 09:45:07][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 09:45:07][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/26/2017 09:45:07][                        Main()] Calling ConnectToTargetCompany()
[07/26/2017 09:45:07][      ConnectToTargetCompany()] Starting function
[07/26/2017 09:45:07][      ConnectToTargetCompany()] Initializing the Company Object
[07/26/2017 09:45:11][      ConnectToTargetCompany()] Assigning the representing database name
[07/26/2017 09:45:11][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/26/2017 09:45:23][      ConnectToTargetCompany()] Completed with SUCCESS
[07/26/2017 09:45:23][                        Main()] Calling IntegrityValidation()
[07/26/2017 09:45:23][         IntegrityValidation()] Starting Function
[07/26/2017 09:45:23][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/26/2017 09:45:23][     MarketingDocuments_Sync()] Starting Function 
[07/26/2017 09:45:23][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/26/2017 09:45:24][          AR_InvoiceCreation()] Starting Function 
[07/26/2017 09:45:34][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/26/2017 09:45:42][          AR_InvoiceCreation()] Draft Added Successfully  84
[07/26/2017 09:45:46][          AR_InvoiceCreation()] Draft Details SQL SELECT T0.[LineNum], T0.[ItemCode], T0.[Quantity], T0.[WhsCode], T1.[ManBtchNum] FROM DRF1 T0 WITH (NOLOCK) INNER JOIN OITM T1 WITH (NOLOCK) ON T0.[ItemCode] = T1.[ItemCode] WHERE T0.[DocEntry] = '84'
[07/26/2017 09:46:01][          AR_InvoiceCreation()] Updating COGS Account  84
[07/26/2017 09:46:11][                Update_Draft()] Starting function
[07/26/2017 09:46:12][                Update_Draft()] Executing the Query, Query String : select T0.[ItemCode],T0.[Project],T0.[CogsAcct],T0.[WhsCode],T0.[LineNum],T0.[TreeType] from DRF1 T0 where DocEntry='84'
[07/26/2017 09:46:12][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:12][            ConvertRecordset()] Starting function
[07/26/2017 09:46:13][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:16][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000002' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:17][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:18][            ConvertRecordset()] Starting function
[07/26/2017 09:46:18][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:57][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:57][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:57][            ConvertRecordset()] Starting function
[07/26/2017 09:46:57][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:57][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:57][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:57][            ConvertRecordset()] Starting function
[07/26/2017 09:46:57][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:57][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:57][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:57][            ConvertRecordset()] Starting function
[07/26/2017 09:46:57][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:57][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000003' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:57][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:57][            ConvertRecordset()] Starting function
[07/26/2017 09:46:57][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:57][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:57][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:57][            ConvertRecordset()] Starting function
[07/26/2017 09:46:57][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:57][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:57][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:57][            ConvertRecordset()] Starting function
[07/26/2017 09:46:57][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:57][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000005' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:57][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:57][            ConvertRecordset()] Starting function
[07/26/2017 09:46:57][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:57][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000007' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000008' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000009' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000010' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000011' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000012' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000014' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000015' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000016' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000018' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000019' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000021' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000024' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000025' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000028' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000029' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000031' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:46:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000200' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:46:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:46:58][            ConvertRecordset()] Starting function
[07/26/2017 09:46:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:47:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'MISC0004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:47:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:47:25][            ConvertRecordset()] Starting function
[07/26/2017 09:47:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:47:25][                Update_Draft()] Before Update the Draft With Update Draft
[07/26/2017 09:47:31][                Update_Draft()] After Update the Draft. Return Value : 0
[07/26/2017 09:47:35][                Update_Draft()] Completed with SUCCESS
[07/26/2017 09:47:39][                Update_Draft()] Releasing the Objects
[07/26/2017 09:47:49][          AR_InvoiceCreation()] Completed with SUCCESS (Update AR Invoice Draft) 
[07/26/2017 09:47:51][          AR_InvoiceCreation()] Attempting to Convert as a AR Invoice Document 
[07/26/2017 09:49:08][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/26/2017 09:49:08][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 09:49:08][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 09:49:08][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 09:49:08][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/26/2017 09:49:08][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 09:49:08][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 09:49:08][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 09:49:08][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/26/2017 09:49:08][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 09:49:08][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 09:49:08][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 09:49:08][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/26/2017 09:49:08][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 09:49:08][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 09:49:08][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 09:49:08][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/26/2017 09:49:08][                        Main()] Calling ConnectToTargetCompany()
[07/26/2017 09:49:08][      ConnectToTargetCompany()] Starting function
[07/26/2017 09:49:08][      ConnectToTargetCompany()] Initializing the Company Object
[07/26/2017 09:49:12][      ConnectToTargetCompany()] Assigning the representing database name
[07/26/2017 09:49:12][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/26/2017 09:49:24][      ConnectToTargetCompany()] Completed with SUCCESS
[07/26/2017 09:49:24][                        Main()] Calling IntegrityValidation()
[07/26/2017 09:49:24][         IntegrityValidation()] Starting Function
[07/26/2017 09:49:24][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/26/2017 09:49:24][     MarketingDocuments_Sync()] Starting Function 
[07/26/2017 09:49:24][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/26/2017 09:49:25][          AR_InvoiceCreation()] Starting Function 
[07/26/2017 09:50:12][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/26/2017 09:50:16][          AR_InvoiceCreation()] Draft Added Successfully  84
[07/26/2017 09:50:17][          AR_InvoiceCreation()] Draft Details SQL SELECT T0.[LineNum], T0.[ItemCode], T0.[Quantity], T0.[WhsCode], T1.[ManBtchNum] FROM DRF1 T0 WITH (NOLOCK) INNER JOIN OITM T1 WITH (NOLOCK) ON T0.[ItemCode] = T1.[ItemCode] WHERE T0.[DocEntry] = '84'
[07/26/2017 09:50:19][          AR_InvoiceCreation()] Updating COGS Account  84
[07/26/2017 09:50:19][                Update_Draft()] Starting function
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String : select T0.[ItemCode],T0.[Project],T0.[CogsAcct],T0.[WhsCode],T0.[LineNum],T0.[TreeType] from DRF1 T0 where DocEntry='84'
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000002' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000003' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000005' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000007' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000008' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000009' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000010' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000011' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000012' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000014' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000015' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000016' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000018' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000019' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000021' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000024' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000025' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000028' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000029' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000031' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000200' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:19][            ConvertRecordset()] Starting function
[07/26/2017 09:50:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:22][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'MISC0004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:50:22][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:50:22][            ConvertRecordset()] Starting function
[07/26/2017 09:50:22][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:50:22][                Update_Draft()] Before Update the Draft With Update Draft
[07/26/2017 09:59:04][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/26/2017 09:59:04][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 09:59:04][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 09:59:05][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 09:59:05][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/26/2017 09:59:05][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 09:59:05][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 09:59:05][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 09:59:05][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/26/2017 09:59:05][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 09:59:05][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 09:59:05][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 09:59:05][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/26/2017 09:59:05][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 09:59:05][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 09:59:05][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 09:59:05][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/26/2017 09:59:05][                        Main()] Calling ConnectToTargetCompany()
[07/26/2017 09:59:05][      ConnectToTargetCompany()] Starting function
[07/26/2017 09:59:05][      ConnectToTargetCompany()] Initializing the Company Object
[07/26/2017 09:59:08][      ConnectToTargetCompany()] Assigning the representing database name
[07/26/2017 09:59:08][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/26/2017 09:59:20][      ConnectToTargetCompany()] Completed with SUCCESS
[07/26/2017 09:59:20][                        Main()] Calling IntegrityValidation()
[07/26/2017 09:59:21][         IntegrityValidation()] Starting Function
[07/26/2017 09:59:21][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/26/2017 09:59:21][     MarketingDocuments_Sync()] Starting Function 
[07/26/2017 09:59:21][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/26/2017 09:59:21][          AR_InvoiceCreation()] Starting Function 
[07/26/2017 09:59:21][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/26/2017 09:59:25][          AR_InvoiceCreation()] Draft Added Successfully  85
[07/26/2017 09:59:25][          AR_InvoiceCreation()] Draft Details SQL SELECT T0.[LineNum], T0.[ItemCode], T0.[Quantity], T0.[WhsCode], T1.[ManBtchNum] FROM DRF1 T0 WITH (NOLOCK) INNER JOIN OITM T1 WITH (NOLOCK) ON T0.[ItemCode] = T1.[ItemCode] WHERE T0.[DocEntry] = '85'
[07/26/2017 09:59:25][          AR_InvoiceCreation()] Updating COGS Account  85
[07/26/2017 09:59:25][                Update_Draft()] Starting function
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String : select T0.[ItemCode],T0.[Project],T0.[CogsAcct],T0.[WhsCode],T0.[LineNum],T0.[TreeType] from DRF1 T0 where DocEntry='85'
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000002' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000003' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000005' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000007' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000008' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000009' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000010' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000011' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000012' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000014' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000015' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000016' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000018' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000019' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000021' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000024' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000025' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000028' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000029' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000031' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000200' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'MISC0004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 09:59:25][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 09:59:25][            ConvertRecordset()] Starting function
[07/26/2017 09:59:25][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 09:59:25][                Update_Draft()] Before Update the Draft With Update Draft
[07/26/2017 09:59:28][                Update_Draft()] After Update the Draft. Return Value : 0
[07/26/2017 09:59:28][                Update_Draft()] Completed with SUCCESS
[07/26/2017 09:59:28][                Update_Draft()] Releasing the Objects
[07/26/2017 09:59:28][          AR_InvoiceCreation()] Completed with SUCCESS (Update AR Invoice Draft) 
[07/26/2017 09:59:28][          AR_InvoiceCreation()] Attempting to Convert as a AR Invoice Document 
[07/26/2017 10:09:41][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/26/2017 10:09:41][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 10:09:41][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 10:09:42][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 10:09:42][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/26/2017 10:09:42][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 10:09:42][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 10:09:42][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 10:09:42][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/26/2017 10:09:42][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 10:09:42][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 10:09:42][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 10:09:42][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/26/2017 10:09:42][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 10:09:42][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 10:09:42][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 10:09:42][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/26/2017 10:09:42][                        Main()] Calling ConnectToTargetCompany()
[07/26/2017 10:09:42][      ConnectToTargetCompany()] Starting function
[07/26/2017 10:09:42][      ConnectToTargetCompany()] Initializing the Company Object
[07/26/2017 10:09:45][      ConnectToTargetCompany()] Assigning the representing database name
[07/26/2017 10:09:45][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/26/2017 10:09:58][      ConnectToTargetCompany()] Completed with SUCCESS
[07/26/2017 10:09:58][                        Main()] Calling IntegrityValidation()
[07/26/2017 10:09:58][         IntegrityValidation()] Starting Function
[07/26/2017 10:09:58][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/26/2017 10:09:58][     MarketingDocuments_Sync()] Starting Function 
[07/26/2017 10:09:58][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/26/2017 10:09:58][          AR_InvoiceCreation()] Starting Function 
[07/26/2017 10:09:58][     MarketingDocuments_Sync()] Rollback the SAP Transaction 
[07/26/2017 10:09:58][     MarketingDocuments_Sync()] Date Time 7/26/2017 10:09 AM
[07/26/2017 10:09:58][     MarketingDocuments_Sync()] Validation Update SQL UPDATE HarrysSAPINTDB.. [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'No matching records found in OWHS table ADMIN' , [ERRDateTime] =  DATEADD(day,datediff(day,0,GETDATE()),0)  WHERE [FileID] = '11JKC180717199010101'
[07/26/2017 10:09:58][     MarketingDocuments_Sync()] Executing Query
[07/26/2017 10:09:59][     MarketingDocuments_Sync()] Committed the Transaction Reference File ID : 11JKC180717199010101
[07/26/2017 10:09:59][         IntegrityValidation()] Completed with SUCCESS 
[07/26/2017 10:09:59][                        Main()] Completed with SUCCESS
[07/26/2017 10:13:41][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/26/2017 10:13:41][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 10:13:41][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 10:13:42][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 10:13:42][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/26/2017 10:13:42][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 10:13:42][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 10:13:42][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 10:13:42][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/26/2017 10:13:42][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 10:13:42][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 10:13:42][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 10:13:42][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/26/2017 10:13:42][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 10:13:42][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 10:13:42][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 10:13:42][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/26/2017 10:13:42][                        Main()] Calling ConnectToTargetCompany()
[07/26/2017 10:13:42][      ConnectToTargetCompany()] Starting function
[07/26/2017 10:13:42][      ConnectToTargetCompany()] Initializing the Company Object
[07/26/2017 10:13:45][      ConnectToTargetCompany()] Assigning the representing database name
[07/26/2017 10:13:45][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/26/2017 10:13:57][      ConnectToTargetCompany()] Completed with SUCCESS
[07/26/2017 10:13:57][                        Main()] Calling IntegrityValidation()
[07/26/2017 10:13:57][         IntegrityValidation()] Starting Function
[07/26/2017 10:13:57][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/26/2017 10:13:57][     MarketingDocuments_Sync()] Starting Function 
[07/26/2017 10:13:57][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/26/2017 10:13:57][          AR_InvoiceCreation()] Starting Function 
[07/26/2017 10:13:58][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/26/2017 10:14:02][          AR_InvoiceCreation()] Draft Added Successfully  86
[07/26/2017 10:14:02][          AR_InvoiceCreation()] Updating COGS Account  86
[07/26/2017 10:14:02][                Update_Draft()] Starting function
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String : select T0.[ItemCode],T0.[Project],T0.[CogsAcct],T0.[WhsCode],T0.[LineNum],T0.[TreeType] from DRF1 T0 where DocEntry='86'
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000002' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000003' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000005' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000007' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000008' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000009' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000010' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000011' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000012' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000014' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000015' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000016' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000018' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000019' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000021' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000024' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000025' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000028' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000029' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000031' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000200' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'MISC0004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:14:02][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:14:02][            ConvertRecordset()] Starting function
[07/26/2017 10:14:02][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:14:02][                Update_Draft()] Before Update the Draft With Update Draft
[07/26/2017 10:14:05][                Update_Draft()] After Update the Draft. Return Value : 0
[07/26/2017 10:14:05][                Update_Draft()] Completed with SUCCESS
[07/26/2017 10:14:05][                Update_Draft()] Releasing the Objects
[07/26/2017 10:14:05][          AR_InvoiceCreation()] Completed with SUCCESS (Update AR Invoice Draft) 
[07/26/2017 10:14:05][          AR_InvoiceCreation()] Attempting to Convert as a AR Invoice Document 
[07/26/2017 10:20:58][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/26/2017 10:20:58][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 10:20:58][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 10:20:58][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 10:20:58][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/26/2017 10:20:58][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 10:20:58][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 10:20:58][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 10:20:58][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/26/2017 10:20:58][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 10:20:58][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 10:20:58][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 10:20:58][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/26/2017 10:20:58][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 10:20:58][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 10:20:58][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 10:20:58][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/26/2017 10:20:58][                        Main()] Calling ConnectToTargetCompany()
[07/26/2017 10:20:58][      ConnectToTargetCompany()] Starting function
[07/26/2017 10:20:58][      ConnectToTargetCompany()] Initializing the Company Object
[07/26/2017 10:21:01][      ConnectToTargetCompany()] Assigning the representing database name
[07/26/2017 10:21:01][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/26/2017 10:21:15][      ConnectToTargetCompany()] Completed with SUCCESS
[07/26/2017 10:21:15][                        Main()] Calling IntegrityValidation()
[07/26/2017 10:21:15][         IntegrityValidation()] Starting Function
[07/26/2017 10:21:15][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/26/2017 10:21:15][     MarketingDocuments_Sync()] Starting Function 
[07/26/2017 10:21:15][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/26/2017 10:21:15][          AR_InvoiceCreation()] Starting Function 
[07/26/2017 10:21:15][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/26/2017 10:21:19][          AR_InvoiceCreation()] Draft Added Successfully  87
[07/26/2017 10:21:19][          AR_InvoiceCreation()] Updating COGS Account  87
[07/26/2017 10:21:19][                Update_Draft()] Starting function
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String : select T0.[ItemCode],T0.[Project],T0.[CogsAcct],T0.[WhsCode],T0.[LineNum],T0.[TreeType] from DRF1 T0 where DocEntry='87'
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000002' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000003' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000005' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000007' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000008' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000009' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000010' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000011' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000012' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000014' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000015' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000016' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000018' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000019' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000021' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000024' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000025' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000028' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000029' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000031' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000200' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'MISC0004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:21:19][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:21:19][            ConvertRecordset()] Starting function
[07/26/2017 10:21:19][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:21:19][                Update_Draft()] Before Update the Draft With Update Draft
[07/26/2017 10:21:23][                Update_Draft()] After Update the Draft. Return Value : 0
[07/26/2017 10:21:23][                Update_Draft()] Completed with SUCCESS
[07/26/2017 10:21:23][                Update_Draft()] Releasing the Objects
[07/26/2017 10:21:23][          AR_InvoiceCreation()] Completed with SUCCESS (Update AR Invoice Draft) 
[07/26/2017 10:21:23][          AR_InvoiceCreation()] Attempting to Convert as a AR Invoice Document 
[07/26/2017 10:28:35][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/26/2017 10:28:35][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 10:28:35][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 10:28:35][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 10:28:35][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/26/2017 10:28:35][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 10:28:35][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 10:28:35][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 10:28:35][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/26/2017 10:28:35][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 10:28:35][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 10:28:35][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 10:28:35][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/26/2017 10:28:35][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 10:28:35][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 10:28:35][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 10:28:35][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/26/2017 10:28:35][                        Main()] Calling ConnectToTargetCompany()
[07/26/2017 10:28:35][      ConnectToTargetCompany()] Starting function
[07/26/2017 10:28:35][      ConnectToTargetCompany()] Initializing the Company Object
[07/26/2017 10:28:39][      ConnectToTargetCompany()] Assigning the representing database name
[07/26/2017 10:28:39][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/26/2017 10:28:53][      ConnectToTargetCompany()] Completed with SUCCESS
[07/26/2017 10:28:53][                        Main()] Calling IntegrityValidation()
[07/26/2017 10:28:53][         IntegrityValidation()] Starting Function
[07/26/2017 10:28:53][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/26/2017 10:28:53][     MarketingDocuments_Sync()] Starting Function 
[07/26/2017 10:28:53][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/26/2017 10:28:54][          AR_InvoiceCreation()] Starting Function 
[07/26/2017 10:28:54][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/26/2017 10:28:58][          AR_InvoiceCreation()] Draft Added Successfully  88
[07/26/2017 10:28:58][          AR_InvoiceCreation()] Updating COGS Account  88
[07/26/2017 10:28:58][                Update_Draft()] Starting function
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String : select T0.[ItemCode],T0.[Project],T0.[CogsAcct],T0.[WhsCode],T0.[LineNum],T0.[TreeType] from DRF1 T0 where DocEntry='88'
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000002' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000003' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000005' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000007' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000008' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000009' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000010' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000011' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000012' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000014' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000015' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000016' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000018' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000019' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000021' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000024' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000025' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000028' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000029' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000031' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000200' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'MISC0004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:28:58][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:28:58][            ConvertRecordset()] Starting function
[07/26/2017 10:28:58][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:28:58][                Update_Draft()] Before Update the Draft With Update Draft
[07/26/2017 10:29:02][                Update_Draft()] After Update the Draft. Return Value : 0
[07/26/2017 10:29:02][                Update_Draft()] Completed with SUCCESS
[07/26/2017 10:29:02][                Update_Draft()] Releasing the Objects
[07/26/2017 10:29:02][          AR_InvoiceCreation()] Completed with SUCCESS (Update AR Invoice Draft) 
[07/26/2017 10:29:02][          AR_InvoiceCreation()] Attempting to Convert as a AR Invoice Document 
[07/26/2017 10:38:07][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/26/2017 10:38:07][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 10:38:07][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 10:38:07][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 10:38:07][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/26/2017 10:38:07][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 10:38:07][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 10:38:07][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 10:38:07][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/26/2017 10:38:07][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 10:38:07][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 10:38:07][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 10:38:07][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/26/2017 10:38:07][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 10:38:07][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 10:38:07][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 10:38:07][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/26/2017 10:38:07][                        Main()] Calling ConnectToTargetCompany()
[07/26/2017 10:38:07][      ConnectToTargetCompany()] Starting function
[07/26/2017 10:38:07][      ConnectToTargetCompany()] Initializing the Company Object
[07/26/2017 10:38:10][      ConnectToTargetCompany()] Assigning the representing database name
[07/26/2017 10:38:10][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/26/2017 10:38:23][      ConnectToTargetCompany()] Completed with SUCCESS
[07/26/2017 10:38:23][                        Main()] Calling IntegrityValidation()
[07/26/2017 10:38:23][         IntegrityValidation()] Starting Function
[07/26/2017 10:38:23][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/26/2017 10:38:23][     MarketingDocuments_Sync()] Starting Function 
[07/26/2017 10:38:23][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/26/2017 10:38:24][          AR_InvoiceCreation()] Starting Function 
[07/26/2017 10:38:24][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/26/2017 10:38:27][          AR_InvoiceCreation()] Draft Added Successfully  89
[07/26/2017 10:38:27][          AR_InvoiceCreation()] Updating COGS Account  89
[07/26/2017 10:38:28][                Update_Draft()] Starting function
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String : select T0.[ItemCode],T0.[Project],T0.[CogsAcct],T0.[WhsCode],T0.[LineNum],T0.[TreeType] from DRF1 T0 where DocEntry='89'
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000002' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000003' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000005' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000007' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000008' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000009' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000010' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000011' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000012' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000014' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000015' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000016' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000018' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000019' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000021' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000024' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000025' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000028' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000029' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000031' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000200' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'MISC0004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 10:38:28][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 10:38:28][            ConvertRecordset()] Starting function
[07/26/2017 10:38:28][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 10:38:28][                Update_Draft()] Before Update the Draft With Update Draft
[07/26/2017 10:38:31][                Update_Draft()] After Update the Draft. Return Value : 0
[07/26/2017 10:38:31][                Update_Draft()] Completed with SUCCESS
[07/26/2017 10:38:31][                Update_Draft()] Releasing the Objects
[07/26/2017 10:38:31][          AR_InvoiceCreation()] Completed with SUCCESS (Update AR Invoice Draft) 
[07/26/2017 10:38:31][          AR_InvoiceCreation()] Attempting to Convert as a AR Invoice Document 
[07/26/2017 10:38:41][          AR_InvoiceCreation()] Completed with SUCCESS (Convert as a AR Invoice Document) 1105
[07/26/2017 10:38:41][          AR_InvoiceCreation()] Attempting to Remove te Draft 
[07/26/2017 10:38:41][          AR_InvoiceCreation()] Completed with SUCCESS
[07/26/2017 10:38:41][     MarketingDocuments_Sync()] Calling Funcion AR_IncomingPayment() : AR Invoice DocEntry 1105
[07/26/2017 10:38:41][            AR_IncomingPayment] Starting Function
[07/26/2017 10:38:42][            AR_IncomingPayment] Completed with ERROR
[07/26/2017 10:38:42][            AR_IncomingPayment] Releasing the Objects
[07/26/2017 10:38:42][     MarketingDocuments_Sync()] Rollback the SAP Transaction 
[07/26/2017 10:38:42][     MarketingDocuments_Sync()] Committed the Transaction Reference File ID : 11JKC180717199010101
[07/26/2017 10:38:42][         IntegrityValidation()] Completed with SUCCESS 
[07/26/2017 10:38:42][                        Main()] Completed with SUCCESS
[07/26/2017 11:28:46][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/26/2017 11:28:46][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 11:28:46][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 11:28:46][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 11:28:46][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/26/2017 11:28:46][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 11:28:46][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 11:28:46][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 11:28:46][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/26/2017 11:28:46][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 11:28:46][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 11:28:46][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 11:28:46][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/26/2017 11:28:46][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 11:28:46][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 11:28:46][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 11:28:46][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/26/2017 11:28:46][                        Main()] Calling ConnectToTargetCompany()
[07/26/2017 11:28:46][      ConnectToTargetCompany()] Starting function
[07/26/2017 11:28:46][      ConnectToTargetCompany()] Initializing the Company Object
[07/26/2017 11:28:50][      ConnectToTargetCompany()] Assigning the representing database name
[07/26/2017 11:28:50][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/26/2017 11:29:03][      ConnectToTargetCompany()] Completed with ERROR
[07/26/2017 11:29:03][                        Main()] Completed with ERROR
[07/26/2017 11:29:41][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/26/2017 11:29:41][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 11:29:41][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 11:29:42][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 11:29:42][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/26/2017 11:29:42][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 11:29:42][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 11:29:42][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 11:29:42][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/26/2017 11:29:42][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 11:29:42][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 11:29:42][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 11:29:42][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/26/2017 11:29:42][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 11:29:42][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 11:29:42][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 11:29:42][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/26/2017 11:29:42][                        Main()] Calling ConnectToTargetCompany()
[07/26/2017 11:29:42][      ConnectToTargetCompany()] Starting function
[07/26/2017 11:29:42][      ConnectToTargetCompany()] Initializing the Company Object
[07/26/2017 11:29:45][      ConnectToTargetCompany()] Assigning the representing database name
[07/26/2017 11:29:45][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/26/2017 11:29:58][      ConnectToTargetCompany()] Completed with SUCCESS
[07/26/2017 11:29:58][                        Main()] Calling IntegrityValidation()
[07/26/2017 11:29:58][         IntegrityValidation()] Starting Function
[07/26/2017 11:29:58][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/26/2017 11:29:58][     MarketingDocuments_Sync()] Starting Function 
[07/26/2017 11:29:58][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/26/2017 11:29:58][          AR_InvoiceCreation()] Starting Function 
[07/26/2017 11:29:59][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/26/2017 11:30:03][          AR_InvoiceCreation()] Draft Added Successfully  90
[07/26/2017 11:30:03][          AR_InvoiceCreation()] Updating COGS Account  90
[07/26/2017 11:30:03][                Update_Draft()] Starting function
[07/26/2017 11:30:03][                Update_Draft()] Executing the Query, Query String : select T0.[ItemCode],T0.[Project],T0.[CogsAcct],T0.[WhsCode],T0.[LineNum],T0.[TreeType] from DRF1 T0 where DocEntry='90'
[07/26/2017 11:30:03][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:03][            ConvertRecordset()] Starting function
[07/26/2017 11:30:03][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:03][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000002' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000003' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000005' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000007' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000008' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000009' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000010' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000011' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000012' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000014' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000015' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000016' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000018' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000019' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000021' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000024' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000025' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000028' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000029' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000031' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000200' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'MISC0004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:30:04][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:30:04][            ConvertRecordset()] Starting function
[07/26/2017 11:30:04][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:30:04][                Update_Draft()] Before Update the Draft With Update Draft
[07/26/2017 11:30:07][                Update_Draft()] After Update the Draft. Return Value : 0
[07/26/2017 11:30:07][                Update_Draft()] Completed with SUCCESS
[07/26/2017 11:30:07][                Update_Draft()] Releasing the Objects
[07/26/2017 11:30:07][          AR_InvoiceCreation()] Completed with SUCCESS (Update AR Invoice Draft) 
[07/26/2017 11:30:07][          AR_InvoiceCreation()] Attempting to Convert as a AR Invoice Document 
[07/26/2017 11:30:54][          AR_InvoiceCreation()] Completed with SUCCESS (Convert as a AR Invoice Document) 1107
[07/26/2017 11:31:01][          AR_InvoiceCreation()] Attempting to Remove te Draft 
[07/26/2017 11:31:06][          AR_InvoiceCreation()] Completed with SUCCESS
[07/26/2017 11:31:38][     MarketingDocuments_Sync()] Calling Funcion AR_IncomingPayment() : AR Invoice DocEntry 1107
[07/26/2017 11:32:00][            AR_IncomingPayment] Starting Function
[07/26/2017 11:33:55][            AR_IncomingPayment] Completed with ERROR
[07/26/2017 11:33:59][            AR_IncomingPayment] Releasing the Objects
[07/26/2017 11:34:05][     MarketingDocuments_Sync()] Rollback the SAP Transaction 
[07/26/2017 11:34:56][     MarketingDocuments_Sync()] Committed the Transaction Reference File ID : 11JKC180717199010101
[07/26/2017 11:34:59][         IntegrityValidation()] Completed with SUCCESS 
[07/26/2017 11:34:59][                        Main()] Completed with SUCCESS
[07/26/2017 11:36:47][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/26/2017 11:36:47][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 11:36:47][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 11:36:47][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 11:36:47][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/26/2017 11:36:47][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 11:36:47][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 11:36:47][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 11:36:47][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/26/2017 11:36:47][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 11:36:47][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 11:36:47][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 11:36:47][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/26/2017 11:36:47][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 11:36:47][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 11:36:47][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 11:36:47][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/26/2017 11:36:47][                        Main()] Calling ConnectToTargetCompany()
[07/26/2017 11:36:47][      ConnectToTargetCompany()] Starting function
[07/26/2017 11:36:47][      ConnectToTargetCompany()] Initializing the Company Object
[07/26/2017 11:36:51][      ConnectToTargetCompany()] Assigning the representing database name
[07/26/2017 11:36:51][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/26/2017 11:37:03][      ConnectToTargetCompany()] Completed with SUCCESS
[07/26/2017 11:37:03][                        Main()] Calling IntegrityValidation()
[07/26/2017 11:37:03][         IntegrityValidation()] Starting Function
[07/26/2017 11:37:03][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/26/2017 11:37:03][     MarketingDocuments_Sync()] Starting Function 
[07/26/2017 11:37:03][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/26/2017 11:37:04][          AR_InvoiceCreation()] Starting Function 
[07/26/2017 11:37:04][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/26/2017 11:37:08][          AR_InvoiceCreation()] Draft Added Successfully  90
[07/26/2017 11:37:08][          AR_InvoiceCreation()] Updating COGS Account  90
[07/26/2017 11:37:08][                Update_Draft()] Starting function
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String : select T0.[ItemCode],T0.[Project],T0.[CogsAcct],T0.[WhsCode],T0.[LineNum],T0.[TreeType] from DRF1 T0 where DocEntry='90'
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000002' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000003' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000005' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000007' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000008' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000009' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000010' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000011' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000012' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000014' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000015' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000016' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000018' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000019' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000021' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000024' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000025' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000028' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000029' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000031' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000200' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'MISC0004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:37:08][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:37:08][            ConvertRecordset()] Starting function
[07/26/2017 11:37:08][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:37:08][                Update_Draft()] Before Update the Draft With Update Draft
[07/26/2017 11:37:12][                Update_Draft()] After Update the Draft. Return Value : 0
[07/26/2017 11:37:12][                Update_Draft()] Completed with SUCCESS
[07/26/2017 11:37:12][                Update_Draft()] Releasing the Objects
[07/26/2017 11:37:12][          AR_InvoiceCreation()] Completed with SUCCESS (Update AR Invoice Draft) 
[07/26/2017 11:37:12][          AR_InvoiceCreation()] Attempting to Convert as a AR Invoice Document 
[07/26/2017 11:37:46][          AR_InvoiceCreation()] Completed with SUCCESS (Convert as a AR Invoice Document) 1107
[07/26/2017 11:37:51][          AR_InvoiceCreation()] Attempting to Remove te Draft 
[07/26/2017 11:37:55][          AR_InvoiceCreation()] Completed with SUCCESS
[07/26/2017 11:38:16][     MarketingDocuments_Sync()] Calling Funcion AR_IncomingPayment() : AR Invoice DocEntry 1107
[07/26/2017 11:38:22][            AR_IncomingPayment] Starting Function
[07/26/2017 11:39:25][            AR_IncomingPayment] Completed with ERROR
[07/26/2017 11:39:27][            AR_IncomingPayment] Releasing the Objects
[07/26/2017 11:39:38][     MarketingDocuments_Sync()] Rollback the SAP Transaction 
[07/26/2017 11:39:38][     MarketingDocuments_Sync()] Date Time 7/26/2017 11:39 AM
[07/26/2017 11:39:38][     MarketingDocuments_Sync()] Validation Update SQL UPDATE HarrysSAPINTDB.. [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Incoming Payments Conversion from string "CASH" to type ''Integer'' is not valid.' , [ERRDateTime] =  DATEADD(day,datediff(day,0,GETDATE()),0)  WHERE [FileID] = '11JKC180717199010101'
[07/26/2017 11:39:38][     MarketingDocuments_Sync()] Executing Query
[07/26/2017 11:39:38][     MarketingDocuments_Sync()] Committed the Transaction Reference File ID : 11JKC180717199010101
[07/26/2017 11:39:38][         IntegrityValidation()] Completed with SUCCESS 
[07/26/2017 11:39:38][                        Main()] Completed with SUCCESS
[07/26/2017 11:41:36][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/26/2017 11:41:36][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 11:41:36][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 11:41:37][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 11:41:37][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/26/2017 11:41:37][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 11:41:37][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 11:41:37][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 11:41:37][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/26/2017 11:41:37][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 11:41:37][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 11:41:37][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 11:41:37][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/26/2017 11:41:37][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 11:41:37][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 11:41:37][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 11:41:37][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/26/2017 11:41:37][                        Main()] Calling ConnectToTargetCompany()
[07/26/2017 11:41:37][      ConnectToTargetCompany()] Starting function
[07/26/2017 11:41:37][      ConnectToTargetCompany()] Initializing the Company Object
[07/26/2017 11:41:40][      ConnectToTargetCompany()] Assigning the representing database name
[07/26/2017 11:41:40][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/26/2017 11:41:52][      ConnectToTargetCompany()] Completed with SUCCESS
[07/26/2017 11:41:52][                        Main()] Calling IntegrityValidation()
[07/26/2017 11:41:52][         IntegrityValidation()] Starting Function
[07/26/2017 11:41:52][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/26/2017 11:41:52][     MarketingDocuments_Sync()] Starting Function 
[07/26/2017 11:41:52][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/26/2017 11:41:52][          AR_InvoiceCreation()] Starting Function 
[07/26/2017 11:41:52][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/26/2017 11:41:56][          AR_InvoiceCreation()] Draft Added Successfully  90
[07/26/2017 11:41:56][          AR_InvoiceCreation()] Updating COGS Account  90
[07/26/2017 11:41:56][                Update_Draft()] Starting function
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String : select T0.[ItemCode],T0.[Project],T0.[CogsAcct],T0.[WhsCode],T0.[LineNum],T0.[TreeType] from DRF1 T0 where DocEntry='90'
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000002' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000003' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000005' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000007' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000008' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000009' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000010' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000011' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000012' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000014' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000015' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000016' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000018' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000019' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000021' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000024' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000025' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000028' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000029' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000031' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000200' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'MISC0004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 11:41:56][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 11:41:56][            ConvertRecordset()] Starting function
[07/26/2017 11:41:56][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 11:41:56][                Update_Draft()] Before Update the Draft With Update Draft
[07/26/2017 11:42:00][                Update_Draft()] After Update the Draft. Return Value : 0
[07/26/2017 11:42:00][                Update_Draft()] Completed with SUCCESS
[07/26/2017 11:42:00][                Update_Draft()] Releasing the Objects
[07/26/2017 11:42:00][          AR_InvoiceCreation()] Completed with SUCCESS (Update AR Invoice Draft) 
[07/26/2017 11:42:00][          AR_InvoiceCreation()] Attempting to Convert as a AR Invoice Document 
[07/26/2017 11:42:55][          AR_InvoiceCreation()] Completed with SUCCESS (Convert as a AR Invoice Document) 1107
[07/26/2017 11:42:55][          AR_InvoiceCreation()] Attempting to Remove te Draft 
[07/26/2017 11:42:56][          AR_InvoiceCreation()] Completed with SUCCESS
[07/26/2017 11:42:56][     MarketingDocuments_Sync()] Calling Funcion AR_IncomingPayment() : AR Invoice DocEntry 1107
[07/26/2017 11:42:56][            AR_IncomingPayment] Starting Function
[07/26/2017 11:43:22][            AR_IncomingPayment] Amount : 199.5
[07/26/2017 11:43:32][            AR_IncomingPayment] Amount : 50
[07/26/2017 11:43:40][            AR_IncomingPayment] Amount : 261.41
[07/26/2017 11:43:48][            AR_IncomingPayment] Amount : 202.7
[07/26/2017 11:43:54][            AR_IncomingPayment] Attempting to Add  
[07/26/2017 11:44:20][            AR_IncomingPayment] Completed with ERROR
[07/26/2017 11:44:20][            AR_IncomingPayment] Releasing the Objects
[07/26/2017 11:44:20][     MarketingDocuments_Sync()] Rollback the SAP Transaction 
[07/26/2017 11:44:20][     MarketingDocuments_Sync()] Date Time 7/26/2017 11:44 AM
[07/26/2017 11:44:20][     MarketingDocuments_Sync()] Validation Update SQL UPDATE HarrysSAPINTDB.. [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Incoming Payments :- Payment method not defined  [RCT3.CrTypeCode][line: 1]' , [ERRDateTime] =  DATEADD(day,datediff(day,0,GETDATE()),0)  WHERE [FileID] = '11JKC180717199010101'
[07/26/2017 11:44:20][     MarketingDocuments_Sync()] Executing Query
[07/26/2017 11:44:20][     MarketingDocuments_Sync()] Committed the Transaction Reference File ID : 11JKC180717199010101
[07/26/2017 11:44:20][         IntegrityValidation()] Completed with SUCCESS 
[07/26/2017 11:44:20][                        Main()] Completed with SUCCESS
[07/26/2017 12:02:05][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/26/2017 12:02:05][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 12:02:05][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 12:02:05][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 12:02:05][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/26/2017 12:02:05][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 12:02:05][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 12:02:05][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 12:02:05][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/26/2017 12:02:05][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 12:02:05][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 12:02:05][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 12:02:05][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/26/2017 12:02:05][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 12:02:05][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 12:02:05][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 12:02:05][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/26/2017 12:02:05][                        Main()] Calling ConnectToTargetCompany()
[07/26/2017 12:02:05][      ConnectToTargetCompany()] Starting function
[07/26/2017 12:02:05][      ConnectToTargetCompany()] Initializing the Company Object
[07/26/2017 12:02:09][      ConnectToTargetCompany()] Assigning the representing database name
[07/26/2017 12:02:09][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/26/2017 12:02:21][      ConnectToTargetCompany()] Completed with SUCCESS
[07/26/2017 12:02:21][                        Main()] Calling IntegrityValidation()
[07/26/2017 12:02:21][         IntegrityValidation()] Starting Function
[07/26/2017 12:02:21][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/26/2017 12:02:21][     MarketingDocuments_Sync()] Starting Function 
[07/26/2017 12:02:21][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/26/2017 12:02:21][          AR_InvoiceCreation()] Starting Function 
[07/26/2017 12:02:22][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/26/2017 12:02:26][          AR_InvoiceCreation()] Draft Added Successfully  90
[07/26/2017 12:02:26][          AR_InvoiceCreation()] Updating COGS Account  90
[07/26/2017 12:02:26][                Update_Draft()] Starting function
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String : select T0.[ItemCode],T0.[Project],T0.[CogsAcct],T0.[WhsCode],T0.[LineNum],T0.[TreeType] from DRF1 T0 where DocEntry='90'
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000002' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000003' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000005' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000007' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000008' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000009' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000010' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000011' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000012' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000014' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000015' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000016' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000018' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000019' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000021' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000024' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000025' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000028' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000029' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000031' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000200' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'MISC0004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:02:26][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:02:26][            ConvertRecordset()] Starting function
[07/26/2017 12:02:26][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:02:26][                Update_Draft()] Before Update the Draft With Update Draft
[07/26/2017 12:02:30][                Update_Draft()] After Update the Draft. Return Value : 0
[07/26/2017 12:02:30][                Update_Draft()] Completed with SUCCESS
[07/26/2017 12:02:30][                Update_Draft()] Releasing the Objects
[07/26/2017 12:02:30][          AR_InvoiceCreation()] Completed with SUCCESS (Update AR Invoice Draft) 
[07/26/2017 12:02:30][          AR_InvoiceCreation()] Attempting to Convert as a AR Invoice Document 
[07/26/2017 12:07:22][          AR_InvoiceCreation()] Completed with SUCCESS (Convert as a AR Invoice Document) 1108
[07/26/2017 12:07:27][          AR_InvoiceCreation()] Attempting to Remove te Draft 
[07/26/2017 12:07:29][          AR_InvoiceCreation()] Completed with SUCCESS
[07/26/2017 12:07:43][     MarketingDocuments_Sync()] Calling Funcion AR_IncomingPayment() : AR Invoice DocEntry 1108
[07/26/2017 12:07:54][            AR_IncomingPayment] Starting Function
[07/26/2017 12:08:09][            AR_IncomingPayment] Amount : 199.5
[07/26/2017 12:08:13][            AR_IncomingPayment] Amount : 50
[07/26/2017 12:08:17][            AR_IncomingPayment] Amount : 261.41
[07/26/2017 12:08:26][            AR_IncomingPayment] Amount : 202.7
[07/26/2017 12:08:31][            AR_IncomingPayment] Attempting to Add  
[07/26/2017 12:12:47][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/26/2017 12:12:47][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 12:12:47][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 12:12:47][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 12:12:47][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/26/2017 12:12:47][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 12:12:47][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 12:12:47][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 12:12:47][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/26/2017 12:12:47][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 12:12:47][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 12:12:47][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 12:12:47][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/26/2017 12:12:47][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 12:12:47][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 12:12:47][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 12:12:47][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/26/2017 12:12:47][                        Main()] Calling ConnectToTargetCompany()
[07/26/2017 12:12:47][      ConnectToTargetCompany()] Starting function
[07/26/2017 12:12:47][      ConnectToTargetCompany()] Initializing the Company Object
[07/26/2017 12:12:50][      ConnectToTargetCompany()] Assigning the representing database name
[07/26/2017 12:12:50][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/26/2017 12:13:03][      ConnectToTargetCompany()] Completed with SUCCESS
[07/26/2017 12:13:03][                        Main()] Calling IntegrityValidation()
[07/26/2017 12:13:03][         IntegrityValidation()] Starting Function
[07/26/2017 12:13:03][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/26/2017 12:13:03][     MarketingDocuments_Sync()] Starting Function 
[07/26/2017 12:13:03][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/26/2017 12:13:03][          AR_InvoiceCreation()] Starting Function 
[07/26/2017 12:13:03][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/26/2017 12:13:07][          AR_InvoiceCreation()] Draft Added Successfully  90
[07/26/2017 12:13:07][          AR_InvoiceCreation()] Updating COGS Account  90
[07/26/2017 12:13:07][                Update_Draft()] Starting function
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String : select T0.[ItemCode],T0.[Project],T0.[CogsAcct],T0.[WhsCode],T0.[LineNum],T0.[TreeType] from DRF1 T0 where DocEntry='90'
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000002' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000003' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000005' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000007' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000008' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000009' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000010' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000011' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000012' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000014' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000015' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000016' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000018' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000019' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000021' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000024' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000025' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000028' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000029' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000031' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000200' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'MISC0004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:13:07][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:13:07][            ConvertRecordset()] Starting function
[07/26/2017 12:13:07][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:13:07][                Update_Draft()] Before Update the Draft With Update Draft
[07/26/2017 12:13:11][                Update_Draft()] After Update the Draft. Return Value : 0
[07/26/2017 12:13:11][                Update_Draft()] Completed with SUCCESS
[07/26/2017 12:13:11][                Update_Draft()] Releasing the Objects
[07/26/2017 12:13:11][          AR_InvoiceCreation()] Completed with SUCCESS (Update AR Invoice Draft) 
[07/26/2017 12:13:11][          AR_InvoiceCreation()] Attempting to Convert as a AR Invoice Document 
[07/26/2017 12:18:11][          AR_InvoiceCreation()] Completed with SUCCESS (Convert as a AR Invoice Document) 1108
[07/26/2017 12:18:11][          AR_InvoiceCreation()] Attempting to Remove te Draft 
[07/26/2017 12:18:11][          AR_InvoiceCreation()] Completed with SUCCESS
[07/26/2017 12:18:11][     MarketingDocuments_Sync()] Calling Funcion AR_IncomingPayment() : AR Invoice DocEntry 1108
[07/26/2017 12:18:11][            AR_IncomingPayment] Starting Function
[07/26/2017 12:18:24][            AR_IncomingPayment] Amount : 199.5
[07/26/2017 12:18:24][            AR_IncomingPayment] Amount : 50
[07/26/2017 12:18:24][            AR_IncomingPayment] Amount : 261.41
[07/26/2017 12:18:24][            AR_IncomingPayment] Amount : 202.7
[07/26/2017 12:18:24][            AR_IncomingPayment] Attempting to Add  
[07/26/2017 12:18:57][            AR_IncomingPayment] Completed with ERROR
[07/26/2017 12:18:57][            AR_IncomingPayment] Releasing the Objects
[07/26/2017 12:18:57][     MarketingDocuments_Sync()] Rollback the SAP Transaction 
[07/26/2017 12:18:57][     MarketingDocuments_Sync()] Date Time 7/26/2017 12:18 PM
[07/26/2017 12:18:57][     MarketingDocuments_Sync()] Validation Update SQL UPDATE HarrysSAPINTDB.. [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Incoming Payments :- Payment means specification missing  [RCT3.VoucherNum][line: 0]' , [ERRDateTime] =  DATEADD(day,datediff(day,0,GETDATE()),0)  WHERE [FileID] = '11JKC180717199010101'
[07/26/2017 12:18:57][     MarketingDocuments_Sync()] Executing Query
[07/26/2017 12:18:57][     MarketingDocuments_Sync()] Committed the Transaction Reference File ID : 11JKC180717199010101
[07/26/2017 12:18:57][         IntegrityValidation()] Completed with SUCCESS 
[07/26/2017 12:18:57][                        Main()] Completed with SUCCESS
[07/26/2017 12:22:18][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/26/2017 12:22:18][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 12:22:18][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 12:22:18][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 12:22:18][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/26/2017 12:22:18][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 12:22:18][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 12:22:18][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 12:22:18][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/26/2017 12:22:18][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 12:22:18][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 12:22:18][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 12:22:18][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/26/2017 12:22:18][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 12:22:18][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 12:22:18][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 12:22:18][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/26/2017 12:22:18][                        Main()] Calling ConnectToTargetCompany()
[07/26/2017 12:22:18][      ConnectToTargetCompany()] Starting function
[07/26/2017 12:22:18][      ConnectToTargetCompany()] Initializing the Company Object
[07/26/2017 12:22:22][      ConnectToTargetCompany()] Assigning the representing database name
[07/26/2017 12:22:22][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/26/2017 12:22:35][      ConnectToTargetCompany()] Completed with SUCCESS
[07/26/2017 12:22:35][                        Main()] Calling IntegrityValidation()
[07/26/2017 12:22:35][         IntegrityValidation()] Starting Function
[07/26/2017 12:22:35][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/26/2017 12:22:35][     MarketingDocuments_Sync()] Starting Function 
[07/26/2017 12:22:35][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/26/2017 12:22:35][          AR_InvoiceCreation()] Starting Function 
[07/26/2017 12:22:35][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/26/2017 12:22:39][          AR_InvoiceCreation()] Draft Added Successfully  90
[07/26/2017 12:22:39][          AR_InvoiceCreation()] Updating COGS Account  90
[07/26/2017 12:22:39][                Update_Draft()] Starting function
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String : select T0.[ItemCode],T0.[Project],T0.[CogsAcct],T0.[WhsCode],T0.[LineNum],T0.[TreeType] from DRF1 T0 where DocEntry='90'
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000002' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000003' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000005' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000007' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000008' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000009' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000010' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000011' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000012' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000014' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000015' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000016' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000018' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000019' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000021' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000024' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000025' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000028' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000029' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000031' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000200' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'MISC0004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:22:39][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:22:39][            ConvertRecordset()] Starting function
[07/26/2017 12:22:39][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:22:39][                Update_Draft()] Before Update the Draft With Update Draft
[07/26/2017 12:22:43][                Update_Draft()] After Update the Draft. Return Value : 0
[07/26/2017 12:22:43][                Update_Draft()] Completed with SUCCESS
[07/26/2017 12:22:43][                Update_Draft()] Releasing the Objects
[07/26/2017 12:22:43][          AR_InvoiceCreation()] Completed with SUCCESS (Update AR Invoice Draft) 
[07/26/2017 12:22:43][          AR_InvoiceCreation()] Attempting to Convert as a AR Invoice Document 
[07/26/2017 12:22:48][          AR_InvoiceCreation()] Completed with SUCCESS (Convert as a AR Invoice Document) 1108
[07/26/2017 12:22:48][          AR_InvoiceCreation()] Attempting to Remove te Draft 
[07/26/2017 12:22:49][          AR_InvoiceCreation()] Completed with SUCCESS
[07/26/2017 12:22:49][     MarketingDocuments_Sync()] Calling Funcion AR_IncomingPayment() : AR Invoice DocEntry 1108
[07/26/2017 12:22:49][            AR_IncomingPayment] Starting Function
[07/26/2017 12:22:49][            AR_IncomingPayment] Amount : 199.5
[07/26/2017 12:22:49][            AR_IncomingPayment] Amount : 50
[07/26/2017 12:22:49][            AR_IncomingPayment] Amount : 261.41
[07/26/2017 12:22:49][            AR_IncomingPayment] Amount : 202.7
[07/26/2017 12:22:49][            AR_IncomingPayment] Attempting to Add  
[07/26/2017 12:25:38][            AR_IncomingPayment] Completed with SUCCESS.
[07/26/2017 12:25:40][            AR_IncomingPayment] Releasing the Objects
[07/26/2017 12:25:54][     MarketingDocuments_Sync()] Date Time 7/26/2017 12:25 PM
[07/26/2017 12:26:01][     MarketingDocuments_Sync()] Validation Update SQL UPDATE HarrysSAPINTDB.. [SalesTransHeader]SET [SAPSyncFileStatus] = 'SUCCESS' ,[SAPSyncErrMsg] = '' , [ERRDateTime] =  DATEADD(day,datediff(day,0,GETDATE()),0)  WHERE [FileID] = '11JKC180717199010101'
[07/26/2017 12:26:02][     MarketingDocuments_Sync()] Executing Query
[07/26/2017 12:26:50][     MarketingDocuments_Sync()] Completed with ERROR
[07/26/2017 12:26:50][     MarketingDocuments_Sync()] Rollback the SAP Transaction 
[07/26/2017 12:26:50][         IntegrityValidation()] Completed with SUCCESS 
[07/26/2017 12:26:50][                        Main()] Completed with SUCCESS
[07/26/2017 12:31:09][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/26/2017 12:31:09][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 12:31:09][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 12:31:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 12:31:09][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/26/2017 12:31:09][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 12:31:09][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 12:31:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 12:31:09][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/26/2017 12:31:09][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 12:31:09][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 12:31:10][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 12:31:10][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/26/2017 12:31:10][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/26/2017 12:31:10][          ExecuteSQLQuery_DT()] Starting function
[07/26/2017 12:31:10][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/26/2017 12:31:10][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/26/2017 12:31:10][                        Main()] Calling ConnectToTargetCompany()
[07/26/2017 12:31:10][      ConnectToTargetCompany()] Starting function
[07/26/2017 12:31:10][      ConnectToTargetCompany()] Initializing the Company Object
[07/26/2017 12:31:13][      ConnectToTargetCompany()] Assigning the representing database name
[07/26/2017 12:31:13][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/26/2017 12:31:25][      ConnectToTargetCompany()] Completed with SUCCESS
[07/26/2017 12:31:25][                        Main()] Calling IntegrityValidation()
[07/26/2017 12:31:25][         IntegrityValidation()] Starting Function
[07/26/2017 12:31:25][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/26/2017 12:31:25][     MarketingDocuments_Sync()] Starting Function 
[07/26/2017 12:31:25][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/26/2017 12:31:25][          AR_InvoiceCreation()] Starting Function 
[07/26/2017 12:31:26][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/26/2017 12:31:30][          AR_InvoiceCreation()] Draft Added Successfully  90
[07/26/2017 12:31:30][          AR_InvoiceCreation()] Updating COGS Account  90
[07/26/2017 12:31:30][                Update_Draft()] Starting function
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String : select T0.[ItemCode],T0.[Project],T0.[CogsAcct],T0.[WhsCode],T0.[LineNum],T0.[TreeType] from DRF1 T0 where DocEntry='90'
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000002' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000003' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000005' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000007' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000008' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000009' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000010' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000011' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000012' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000014' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000015' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000016' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000018' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000019' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000021' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000024' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000025' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000028' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000029' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000031' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000200' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'MISC0004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/26/2017 12:31:30][                Update_Draft()] Calling ConvertRecordset()
[07/26/2017 12:31:30][            ConvertRecordset()] Starting function
[07/26/2017 12:31:30][            ConvertRecordset()] Completed with SUCCESS
[07/26/2017 12:31:30][                Update_Draft()] Before Update the Draft With Update Draft
[07/26/2017 12:31:34][                Update_Draft()] After Update the Draft. Return Value : 0
[07/26/2017 12:31:34][                Update_Draft()] Completed with SUCCESS
[07/26/2017 12:31:34][                Update_Draft()] Releasing the Objects
[07/26/2017 12:31:34][          AR_InvoiceCreation()] Completed with SUCCESS (Update AR Invoice Draft) 
[07/26/2017 12:31:34][          AR_InvoiceCreation()] Attempting to Convert as a AR Invoice Document 
[07/26/2017 12:31:40][          AR_InvoiceCreation()] Completed with SUCCESS (Convert as a AR Invoice Document) 1108
[07/26/2017 12:31:40][          AR_InvoiceCreation()] Attempting to Remove te Draft 
[07/26/2017 12:31:40][          AR_InvoiceCreation()] Completed with SUCCESS
[07/26/2017 12:31:40][     MarketingDocuments_Sync()] Calling Funcion AR_IncomingPayment() : AR Invoice DocEntry 1108
[07/26/2017 12:31:40][            AR_IncomingPayment] Starting Function
[07/26/2017 12:31:40][            AR_IncomingPayment] Amount : 199.5
[07/26/2017 12:31:40][            AR_IncomingPayment] Amount : 50
[07/26/2017 12:31:40][            AR_IncomingPayment] Amount : 261.41
[07/26/2017 12:31:40][            AR_IncomingPayment] Amount : 202.7
[07/26/2017 12:31:40][            AR_IncomingPayment] Attempting to Add  
[07/26/2017 12:35:36][            AR_IncomingPayment] Completed with SUCCESS.
[07/26/2017 12:35:37][            AR_IncomingPayment] Releasing the Objects
[07/26/2017 12:35:46][     MarketingDocuments_Sync()] Date Time 7/26/2017 12:35 PM
[07/26/2017 12:35:52][     MarketingDocuments_Sync()] Validation Update SQL UPDATE HarrysSAPINTDB.. [SalesTransHeader]SET [SAPSyncFileStatus] = 'SUCCESS' ,[SAPSyncErrMsg] = '' , [ERRDateTime] =  DATEADD(day,datediff(day,0,GETDATE()),0)  WHERE [FileID] = '11JKC180717199010101'
[07/26/2017 12:35:53][     MarketingDocuments_Sync()] Executing Query
[07/26/2017 12:36:00][     MarketingDocuments_Sync()] Committed the Transaction Reference File ID : 11JKC180717199010101
[07/26/2017 12:36:00][         IntegrityValidation()] Completed with SUCCESS 
[07/26/2017 12:36:00][                        Main()] Completed with SUCCESS
[07/29/2017 09:54:22][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[07/29/2017 09:54:22][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/29/2017 09:54:22][          ExecuteSQLQuery_DT()] Starting function
[07/29/2017 09:54:22][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/29/2017 09:54:22][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[07/29/2017 09:54:22][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/29/2017 09:54:22][          ExecuteSQLQuery_DT()] Starting function
[07/29/2017 09:54:22][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/29/2017 09:54:22][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[07/29/2017 09:54:22][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/29/2017 09:54:22][          ExecuteSQLQuery_DT()] Starting function
[07/29/2017 09:54:22][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/29/2017 09:54:22][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[07/29/2017 09:54:22][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[07/29/2017 09:54:22][          ExecuteSQLQuery_DT()] Starting function
[07/29/2017 09:54:22][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[07/29/2017 09:54:22][      GetSystemIntializeInfo()] Completed with SUCCESS
[07/29/2017 09:54:22][                        Main()] Calling ConnectToTargetCompany()
[07/29/2017 09:54:22][      ConnectToTargetCompany()] Starting function
[07/29/2017 09:54:22][      ConnectToTargetCompany()] Initializing the Company Object
[07/29/2017 09:54:26][      ConnectToTargetCompany()] Assigning the representing database name
[07/29/2017 09:54:26][      ConnectToTargetCompany()] Connecting to the Company Database.
[07/29/2017 09:54:38][      ConnectToTargetCompany()] Completed with SUCCESS
[07/29/2017 09:54:38][                        Main()] Calling IntegrityValidation()
[07/29/2017 09:54:39][         IntegrityValidation()] Starting Function
[07/29/2017 09:54:39][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[07/29/2017 09:54:39][     MarketingDocuments_Sync()] Starting Function 
[07/29/2017 09:54:39][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[07/29/2017 09:54:39][          AR_InvoiceCreation()] Starting Function 
[07/29/2017 09:54:39][          AR_InvoiceCreation()] Attempting to Add Draft 
[07/29/2017 09:54:43][          AR_InvoiceCreation()] Draft Added Successfully  91
[07/29/2017 09:54:43][          AR_InvoiceCreation()] Updating COGS Account  91
[07/29/2017 09:54:43][                Update_Draft()] Starting function
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String : select T0.[ItemCode],T0.[Project],T0.[CogsAcct],T0.[WhsCode],T0.[LineNum],T0.[TreeType] from DRF1 T0 where DocEntry='91'
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000002' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000003' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000005' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000007' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000008' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000009' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000010' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000011' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000012' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000014' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000015' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000016' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000018' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000019' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000021' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000024' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000025' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'sTRADEDDISCOUNT' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000028' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000029' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000031' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'SG10000200' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Executing the Query, Query String :  WITH BOM (Code, Level, TreeType) AS ( SELECT T0.Code, 0 as Level, T2.TreeType  FROM dbo.OITT T0 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T0.Code = T2.ItemCode  WHERE T0.Code = 'MISC0004' UNION ALL   SELECT T1.Code , Level +1 , T2.TreeType   FROM  dbo.ITT1 AS T1 WITH(NOLOCK) inner join OITM T2 WITH(NOLOCK) on T1.Code = T2.ItemCode JOIN BOM ON T1.Father = BOM.Code AND BOM.TreeType ='S' )  SELECT COUNT(Code) FROM BOM  WHERE Code NOT IN (SELECT Code FROM OITT WITH(NOLOCK) WHERE TreeType ='S') OPTION (MAXRECURSION 99) 
[07/29/2017 09:54:43][                Update_Draft()] Calling ConvertRecordset()
[07/29/2017 09:54:43][            ConvertRecordset()] Starting function
[07/29/2017 09:54:43][            ConvertRecordset()] Completed with SUCCESS
[07/29/2017 09:54:43][                Update_Draft()] Before Update the Draft With Update Draft
[07/29/2017 09:54:46][                Update_Draft()] After Update the Draft. Return Value : 0
[07/29/2017 09:54:46][                Update_Draft()] Completed with SUCCESS
[07/29/2017 09:54:46][                Update_Draft()] Releasing the Objects
[07/29/2017 09:54:46][          AR_InvoiceCreation()] Completed with SUCCESS (Update AR Invoice Draft) 
[07/29/2017 09:54:46][          AR_InvoiceCreation()] Attempting to Convert as a AR Invoice Document 
[07/29/2017 09:54:52][          AR_InvoiceCreation()] Completed with SUCCESS (Convert as a AR Invoice Document) 1109
[07/29/2017 09:54:52][          AR_InvoiceCreation()] Attempting to Remove te Draft 
[07/29/2017 09:54:52][          AR_InvoiceCreation()] Completed with SUCCESS
[07/29/2017 09:54:52][     MarketingDocuments_Sync()] Calling Funcion AR_IncomingPayment() : AR Invoice DocEntry 1109
[07/29/2017 09:54:52][            AR_IncomingPayment] Starting Function
[07/29/2017 09:54:52][            AR_IncomingPayment] Amount : 199.5
[07/29/2017 09:54:52][            AR_IncomingPayment] Amount : 50
[07/29/2017 09:54:52][            AR_IncomingPayment] Amount : 261.41
[07/29/2017 09:54:52][            AR_IncomingPayment] Amount : 202.7
[07/29/2017 09:54:52][            AR_IncomingPayment] Attempting to Add  
[07/29/2017 09:55:04][            AR_IncomingPayment] Completed with SUCCESS.
[07/29/2017 09:55:04][            AR_IncomingPayment] Releasing the Objects
[07/29/2017 09:55:04][     MarketingDocuments_Sync()] Date Time 7/29/2017 9:55 AM
[07/29/2017 09:55:04][     MarketingDocuments_Sync()] Validation Update SQL UPDATE HarrysSAPINTDB.. [SalesTransHeader]SET [SAPSyncFileStatus] = 'SUCCESS' ,[SAPSyncErrMsg] = '' , [ERRDateTime] =  DATEADD(day,datediff(day,0,GETDATE()),0)  WHERE [FileID] = '11JKC180717199010101'
[07/29/2017 09:55:04][     MarketingDocuments_Sync()] Executing Query
[07/29/2017 09:55:05][     MarketingDocuments_Sync()] Committed the Transaction Reference File ID : 11JKC180717199010101
[07/29/2017 09:55:05][         IntegrityValidation()] Completed with SUCCESS 
[07/29/2017 09:55:05][                        Main()] Completed with SUCCESS
[08/02/2017 10:26:37][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/02/2017 10:26:38][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:26:38][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:26:39][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:26:41][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/02/2017 10:26:50][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:26:50][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:26:50][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:26:52][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/02/2017 10:26:53][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:26:55][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:26:55][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:26:56][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/02/2017 10:26:57][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:26:58][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:26:58][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:27:01][      GetSystemIntializeInfo()] Warehouse : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/02/2017 10:27:03][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:27:03][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:27:03][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:31:57][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/02/2017 10:31:57][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:31:57][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:31:57][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:31:57][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/02/2017 10:31:57][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:31:57][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:31:57][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:31:57][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/02/2017 10:31:57][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:31:57][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:31:57][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:31:57][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/02/2017 10:31:57][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:31:57][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:31:57][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:31:57][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/02/2017 10:31:57][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:31:57][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:31:57][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:31:57][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/02/2017 10:31:57][                        Main()] Calling ConnectToTargetCompany()
[08/02/2017 10:31:57][      ConnectToTargetCompany()] Starting function
[08/02/2017 10:31:57][      ConnectToTargetCompany()] Initializing the Company Object
[08/02/2017 10:32:01][      ConnectToTargetCompany()] Assigning the representing database name
[08/02/2017 10:32:01][      ConnectToTargetCompany()] Connecting to the Company Database.
[08/02/2017 10:32:26][      ConnectToTargetCompany()] Completed with SUCCESS
[08/02/2017 10:32:26][                        Main()] Calling IntegrityValidation()
[08/02/2017 10:32:26][         IntegrityValidation()] Starting Function
[08/02/2017 10:32:26][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/02/2017 10:32:26][     MarketingDocuments_Sync()] Starting Function 
[08/02/2017 10:32:26][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/02/2017 10:32:26][          AR_InvoiceCreation()] Starting Function 
[08/02/2017 10:36:20][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/02/2017 10:36:20][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:36:20][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:36:21][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:36:21][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/02/2017 10:36:21][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:36:21][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:36:21][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:36:21][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/02/2017 10:36:21][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:36:21][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:36:21][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:36:21][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/02/2017 10:36:21][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:36:21][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:36:21][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:36:21][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/02/2017 10:36:21][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:36:21][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:36:21][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:36:21][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/02/2017 10:36:21][                        Main()] Calling ConnectToTargetCompany()
[08/02/2017 10:36:21][      ConnectToTargetCompany()] Starting function
[08/02/2017 10:36:21][      ConnectToTargetCompany()] Initializing the Company Object
[08/02/2017 10:36:24][      ConnectToTargetCompany()] Assigning the representing database name
[08/02/2017 10:36:24][      ConnectToTargetCompany()] Connecting to the Company Database.
[08/02/2017 10:36:36][      ConnectToTargetCompany()] Completed with SUCCESS
[08/02/2017 10:36:36][                        Main()] Calling IntegrityValidation()
[08/02/2017 10:36:36][         IntegrityValidation()] Starting Function
[08/02/2017 10:36:36][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/02/2017 10:36:36][     MarketingDocuments_Sync()] Starting Function 
[08/02/2017 10:36:58][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/02/2017 10:36:59][          AR_InvoiceCreation()] Starting Function 
[08/02/2017 10:37:28][          AR_InvoiceCreation()] Attempting to Add Draft 
[08/02/2017 10:38:52][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/02/2017 10:38:52][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:38:52][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:38:52][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:38:52][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/02/2017 10:38:52][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:38:52][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:38:52][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:38:52][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/02/2017 10:38:52][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:38:52][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:38:52][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:38:52][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/02/2017 10:38:52][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:38:52][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:38:52][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:38:52][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/02/2017 10:38:52][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:38:52][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:38:52][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:38:52][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/02/2017 10:38:52][                        Main()] Calling ConnectToTargetCompany()
[08/02/2017 10:38:52][      ConnectToTargetCompany()] Starting function
[08/02/2017 10:38:52][      ConnectToTargetCompany()] Initializing the Company Object
[08/02/2017 10:38:56][      ConnectToTargetCompany()] Assigning the representing database name
[08/02/2017 10:38:56][      ConnectToTargetCompany()] Connecting to the Company Database.
[08/02/2017 10:39:08][      ConnectToTargetCompany()] Completed with SUCCESS
[08/02/2017 10:39:08][                        Main()] Calling IntegrityValidation()
[08/02/2017 10:39:08][         IntegrityValidation()] Starting Function
[08/02/2017 10:39:08][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/02/2017 10:39:08][     MarketingDocuments_Sync()] Starting Function 
[08/02/2017 10:39:14][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/02/2017 10:39:14][          AR_InvoiceCreation()] Starting Function 
[08/02/2017 10:46:25][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/02/2017 10:46:25][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:46:25][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:46:26][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:46:26][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/02/2017 10:46:26][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:46:26][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:46:26][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:46:26][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/02/2017 10:46:26][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:46:26][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:46:26][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:46:26][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/02/2017 10:46:26][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:46:26][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:46:26][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:46:26][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/02/2017 10:46:26][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:46:26][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:46:26][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:46:26][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/02/2017 10:46:26][                        Main()] Calling ConnectToTargetCompany()
[08/02/2017 10:46:26][      ConnectToTargetCompany()] Starting function
[08/02/2017 10:46:26][      ConnectToTargetCompany()] Initializing the Company Object
[08/02/2017 10:46:30][      ConnectToTargetCompany()] Assigning the representing database name
[08/02/2017 10:46:30][      ConnectToTargetCompany()] Connecting to the Company Database.
[08/02/2017 10:46:43][      ConnectToTargetCompany()] Completed with SUCCESS
[08/02/2017 10:46:43][                        Main()] Calling IntegrityValidation()
[08/02/2017 10:46:43][         IntegrityValidation()] Starting Function
[08/02/2017 10:46:43][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/02/2017 10:46:43][     MarketingDocuments_Sync()] Starting Function 
[08/02/2017 10:46:43][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/02/2017 10:46:43][          AR_InvoiceCreation()] Starting Function 
[08/02/2017 10:47:37][          AR_InvoiceCreation()] Attempting to Add Draft 
[08/02/2017 10:51:11][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/02/2017 10:51:11][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:51:11][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:51:11][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:51:11][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/02/2017 10:51:11][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:51:11][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:51:11][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:51:11][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/02/2017 10:51:11][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:51:11][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:51:11][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:51:11][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/02/2017 10:51:11][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:51:11][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:51:11][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:51:11][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/02/2017 10:51:11][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:51:11][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:51:11][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:51:11][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/02/2017 10:51:11][                        Main()] Calling ConnectToTargetCompany()
[08/02/2017 10:51:11][      ConnectToTargetCompany()] Starting function
[08/02/2017 10:51:11][      ConnectToTargetCompany()] Initializing the Company Object
[08/02/2017 10:51:15][      ConnectToTargetCompany()] Assigning the representing database name
[08/02/2017 10:51:15][      ConnectToTargetCompany()] Connecting to the Company Database.
[08/02/2017 10:51:27][      ConnectToTargetCompany()] Completed with SUCCESS
[08/02/2017 10:51:27][                        Main()] Calling IntegrityValidation()
[08/02/2017 10:51:27][         IntegrityValidation()] Starting Function
[08/02/2017 10:51:27][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/02/2017 10:51:27][     MarketingDocuments_Sync()] Starting Function 
[08/02/2017 10:51:27][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/02/2017 10:51:27][          AR_InvoiceCreation()] Starting Function 
[08/02/2017 10:51:28][          AR_InvoiceCreation()] Attempting to Add Draft 
[08/02/2017 10:54:17][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/02/2017 10:54:17][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:54:17][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:54:17][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:54:17][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/02/2017 10:54:17][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:54:17][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:54:17][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:54:17][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/02/2017 10:54:17][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:54:17][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:54:17][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:54:17][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/02/2017 10:54:17][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 10:54:17][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 10:54:17][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 10:54:17][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/02/2017 10:54:17][                        Main()] Calling ConnectToTargetCompany()
[08/02/2017 10:54:17][      ConnectToTargetCompany()] Starting function
[08/02/2017 10:54:17][      ConnectToTargetCompany()] Initializing the Company Object
[08/02/2017 10:54:23][      ConnectToTargetCompany()] Assigning the representing database name
[08/02/2017 10:54:23][      ConnectToTargetCompany()] Connecting to the Company Database.
[08/02/2017 10:54:48][      ConnectToTargetCompany()] Completed with SUCCESS
[08/02/2017 10:54:48][                        Main()] Calling IntegrityValidation()
[08/02/2017 10:54:48][         IntegrityValidation()] Starting Function
[08/02/2017 10:54:48][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/02/2017 10:54:48][     MarketingDocuments_Sync()] Starting Function 
[08/02/2017 10:54:48][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/02/2017 10:54:49][          AR_InvoiceCreation()] Starting Function 
[08/02/2017 10:54:49][          AR_InvoiceCreation()] Attempting to Add Draft 
[08/02/2017 11:00:20][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/02/2017 11:00:20][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 11:00:20][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 11:00:21][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 11:00:21][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/02/2017 11:00:21][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 11:00:21][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 11:00:21][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 11:00:21][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/02/2017 11:00:21][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 11:00:21][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 11:00:21][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 11:00:21][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/02/2017 11:00:21][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 11:00:21][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 11:00:21][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 11:00:21][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/02/2017 11:00:21][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 11:00:21][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 11:00:21][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 11:00:21][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/02/2017 11:00:21][                        Main()] Calling ConnectToTargetCompany()
[08/02/2017 11:00:21][      ConnectToTargetCompany()] Starting function
[08/02/2017 11:00:21][      ConnectToTargetCompany()] Initializing the Company Object
[08/02/2017 11:00:24][      ConnectToTargetCompany()] Assigning the representing database name
[08/02/2017 11:00:24][      ConnectToTargetCompany()] Connecting to the Company Database.
[08/02/2017 11:00:38][      ConnectToTargetCompany()] Completed with SUCCESS
[08/02/2017 11:00:38][                        Main()] Calling IntegrityValidation()
[08/02/2017 11:00:38][         IntegrityValidation()] Starting Function
[08/02/2017 11:00:38][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/02/2017 11:00:38][     MarketingDocuments_Sync()] Starting Function 
[08/02/2017 11:00:38][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/02/2017 11:00:38][          AR_InvoiceCreation()] Starting Function 
[08/02/2017 11:04:08][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/02/2017 11:04:08][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 11:04:08][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 11:04:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 11:04:09][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/02/2017 11:04:09][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 11:04:09][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 11:04:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 11:04:09][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/02/2017 11:04:09][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 11:04:09][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 11:04:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 11:04:09][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/02/2017 11:04:09][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 11:04:09][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 11:04:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 11:04:09][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/02/2017 11:04:09][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 11:04:09][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 11:04:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 11:04:09][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/02/2017 11:04:09][                        Main()] Calling ConnectToTargetCompany()
[08/02/2017 11:04:09][      ConnectToTargetCompany()] Starting function
[08/02/2017 11:04:09][      ConnectToTargetCompany()] Initializing the Company Object
[08/02/2017 11:04:13][      ConnectToTargetCompany()] Assigning the representing database name
[08/02/2017 11:04:13][      ConnectToTargetCompany()] Connecting to the Company Database.
[08/02/2017 11:04:36][      ConnectToTargetCompany()] Completed with SUCCESS
[08/02/2017 11:04:36][                        Main()] Calling IntegrityValidation()
[08/02/2017 11:04:36][         IntegrityValidation()] Starting Function
[08/02/2017 11:04:36][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/02/2017 11:04:36][     MarketingDocuments_Sync()] Starting Function 
[08/02/2017 11:04:36][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/02/2017 11:04:36][          AR_InvoiceCreation()] Starting Function 
[08/02/2017 11:04:36][          AR_InvoiceCreation()] Attempting to Add Draft 
[08/02/2017 11:19:56][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/02/2017 11:19:56][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 11:19:56][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 11:19:57][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 11:19:57][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/02/2017 11:19:57][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 11:19:57][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 11:19:57][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 11:19:57][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/02/2017 11:19:57][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 11:19:57][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 11:19:57][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 11:19:57][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/02/2017 11:19:57][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 11:19:57][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 11:19:57][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 11:19:57][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/02/2017 11:19:57][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 11:19:57][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 11:19:57][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 11:19:57][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/02/2017 11:19:57][                        Main()] Calling ConnectToTargetCompany()
[08/02/2017 11:19:57][      ConnectToTargetCompany()] Starting function
[08/02/2017 11:19:57][      ConnectToTargetCompany()] Initializing the Company Object
[08/02/2017 11:20:01][      ConnectToTargetCompany()] Assigning the representing database name
[08/02/2017 11:20:01][      ConnectToTargetCompany()] Connecting to the Company Database.
[08/02/2017 11:20:15][      ConnectToTargetCompany()] Completed with SUCCESS
[08/02/2017 11:20:15][                        Main()] Calling IntegrityValidation()
[08/02/2017 11:20:15][         IntegrityValidation()] Starting Function
[08/02/2017 11:20:15][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/02/2017 11:20:15][     MarketingDocuments_Sync()] Starting Function 
[08/02/2017 11:20:15][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/02/2017 11:20:15][          AR_InvoiceCreation()] Starting Function 
[08/02/2017 11:24:04][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/02/2017 11:24:04][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 11:24:04][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 11:24:05][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 11:24:05][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/02/2017 11:24:05][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 11:24:05][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 11:24:05][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 11:24:05][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/02/2017 11:24:05][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 11:24:05][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 11:24:06][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 11:24:06][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/02/2017 11:24:06][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 11:24:06][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 11:24:06][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 11:24:06][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/02/2017 11:24:06][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/02/2017 11:24:06][          ExecuteSQLQuery_DT()] Starting function
[08/02/2017 11:24:06][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/02/2017 11:24:06][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/02/2017 11:24:06][                        Main()] Calling ConnectToTargetCompany()
[08/02/2017 11:24:06][      ConnectToTargetCompany()] Starting function
[08/02/2017 11:24:06][      ConnectToTargetCompany()] Initializing the Company Object
[08/02/2017 11:24:09][      ConnectToTargetCompany()] Assigning the representing database name
[08/02/2017 11:24:09][      ConnectToTargetCompany()] Connecting to the Company Database.
[08/02/2017 11:24:34][      ConnectToTargetCompany()] Completed with SUCCESS
[08/02/2017 11:24:34][                        Main()] Calling IntegrityValidation()
[08/02/2017 11:24:34][         IntegrityValidation()] Starting Function
[08/02/2017 11:24:34][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/02/2017 11:24:34][     MarketingDocuments_Sync()] Starting Function 
[08/02/2017 11:24:34][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/02/2017 11:24:34][          AR_InvoiceCreation()] Starting Function 
[08/02/2017 11:24:34][          AR_InvoiceCreation()] Attempting to Add Draft 
[08/10/2017 10:28:59][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/10/2017 10:28:59][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 10:28:59][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 10:29:00][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 10:29:00][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/10/2017 10:29:00][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 10:29:00][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 10:29:01][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 10:29:01][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/10/2017 10:29:01][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 10:29:01][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 10:29:01][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 10:29:01][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/10/2017 10:29:01][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 10:29:01][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 10:29:01][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 10:29:01][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/10/2017 10:29:01][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 10:29:01][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 10:29:01][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 10:29:01][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/10/2017 10:29:24][                        Main()] Calling ConnectToTargetCompany()
[08/10/2017 10:29:26][      ConnectToTargetCompany()] Starting function
[08/10/2017 10:29:26][      ConnectToTargetCompany()] Initializing the Company Object
[08/10/2017 10:29:29][      ConnectToTargetCompany()] Assigning the representing database name
[08/10/2017 10:29:29][      ConnectToTargetCompany()] Connecting to the Company Database.  UAT_HSukiGroup
[08/10/2017 10:29:50][      ConnectToTargetCompany()] Completed with SUCCESS
[08/10/2017 10:43:41][                        Main()] Calling IntegrityValidation()
[08/10/2017 10:43:42][         IntegrityValidation()] Starting Function
[08/10/2017 10:43:42][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/10/2017 10:43:48][     MarketingDocuments_Sync()] Starting Function 
[08/10/2017 10:43:54][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/10/2017 10:43:55][          AR_InvoiceCreation()] Starting Function 
[08/10/2017 10:43:55][          AR_InvoiceCreation()] Completed with ERROR
[08/10/2017 10:43:55][          AR_InvoiceCreation()] Rollback the SAP Transaction 
[08/10/2017 10:44:24][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/10/2017 10:44:24][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 10:44:24][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 10:44:25][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 10:44:25][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/10/2017 10:44:25][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 10:44:25][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 10:44:25][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 10:44:25][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/10/2017 10:44:25][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 10:44:25][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 10:44:25][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 10:44:25][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/10/2017 10:44:25][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 10:44:25][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 10:44:25][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 10:44:25][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/10/2017 10:44:25][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 10:44:25][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 10:44:25][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 10:44:25][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/10/2017 10:44:25][                        Main()] Calling ConnectToTargetCompany()
[08/10/2017 10:44:25][      ConnectToTargetCompany()] Starting function
[08/10/2017 10:44:25][      ConnectToTargetCompany()] Initializing the Company Object
[08/10/2017 10:44:28][      ConnectToTargetCompany()] Assigning the representing database name
[08/10/2017 10:44:28][      ConnectToTargetCompany()] Connecting to the Company Database.  UAT_HSukiGroup
[08/10/2017 10:44:42][      ConnectToTargetCompany()] Completed with SUCCESS
[08/10/2017 10:44:42][                        Main()] Calling IntegrityValidation()
[08/10/2017 10:44:42][         IntegrityValidation()] Starting Function
[08/10/2017 10:44:42][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/10/2017 11:28:49][     MarketingDocuments_Sync()] Starting Function 
[08/10/2017 11:29:17][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/10/2017 11:29:50][          AR_InvoiceCreation()] Starting Function 
[08/10/2017 11:46:57][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/10/2017 11:46:57][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 11:46:57][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 11:46:57][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 11:46:57][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/10/2017 11:46:57][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 11:46:57][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 11:46:57][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 11:46:57][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/10/2017 11:46:57][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 11:46:57][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 11:46:57][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 11:46:57][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/10/2017 11:46:57][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 11:46:57][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 11:46:57][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 11:46:57][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/10/2017 11:46:57][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 11:46:57][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 11:46:57][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 11:46:57][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/10/2017 11:46:57][                        Main()] Calling ConnectToTargetCompany()
[08/10/2017 11:46:57][      ConnectToTargetCompany()] Starting function
[08/10/2017 11:46:57][      ConnectToTargetCompany()] Initializing the Company Object
[08/10/2017 11:47:01][      ConnectToTargetCompany()] Assigning the representing database name
[08/10/2017 11:47:01][      ConnectToTargetCompany()] Connecting to the Company Database.  UAT_HSukiGroup
[08/10/2017 11:47:14][      ConnectToTargetCompany()] Completed with SUCCESS
[08/10/2017 11:47:14][                        Main()] Calling IntegrityValidation()
[08/10/2017 11:47:14][         IntegrityValidation()] Starting Function
[08/10/2017 11:47:14][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/10/2017 11:47:26][     MarketingDocuments_Sync()] Starting Function 
[08/10/2017 11:47:35][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/10/2017 11:47:42][          AR_InvoiceCreation()] Starting Function 
[08/10/2017 11:48:28][          AR_InvoiceCreation()] Completed with ERROR
[08/10/2017 11:48:28][          AR_InvoiceCreation()] Rollback the SAP Transaction 
[08/10/2017 11:48:28][     MarketingDocuments_Sync()] Completed with ERROR
[08/10/2017 11:48:28][     MarketingDocuments_Sync()] Rollback the SAP Transaction 
[08/10/2017 11:48:28][         IntegrityValidation()] Completed with SUCCESS 
[08/10/2017 11:48:28][                        Main()] Completed with SUCCESS
[08/10/2017 11:49:27][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/10/2017 11:49:27][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 11:49:27][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 11:49:27][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 11:49:27][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/10/2017 11:49:27][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 11:49:27][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 11:49:27][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 11:49:27][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/10/2017 11:49:27][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 11:49:27][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 11:49:27][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 11:49:27][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/10/2017 11:49:27][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 11:49:27][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 11:49:27][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 11:49:27][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/10/2017 11:49:27][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 11:49:27][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 11:49:27][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 11:49:27][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/10/2017 11:49:27][                        Main()] Calling ConnectToTargetCompany()
[08/10/2017 11:49:27][      ConnectToTargetCompany()] Starting function
[08/10/2017 11:49:27][      ConnectToTargetCompany()] Initializing the Company Object
[08/10/2017 11:49:31][      ConnectToTargetCompany()] Assigning the representing database name
[08/10/2017 11:49:31][      ConnectToTargetCompany()] Connecting to the Company Database.  UAT_HSukiGroup
[08/10/2017 11:49:45][      ConnectToTargetCompany()] Completed with SUCCESS
[08/10/2017 11:49:45][                        Main()] Calling IntegrityValidation()
[08/10/2017 11:49:45][         IntegrityValidation()] Starting Function
[08/10/2017 11:49:45][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/10/2017 11:49:49][     MarketingDocuments_Sync()] Starting Function 
[08/10/2017 11:49:49][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/10/2017 11:49:53][          AR_InvoiceCreation()] Starting Function 
[08/10/2017 12:06:47][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/10/2017 12:06:47][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 12:06:47][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 12:06:47][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 12:06:47][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/10/2017 12:06:47][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 12:06:47][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 12:06:47][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 12:06:47][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/10/2017 12:06:47][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 12:06:47][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 12:06:47][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 12:06:47][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/10/2017 12:06:47][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 12:06:47][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 12:06:47][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 12:06:47][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/10/2017 12:06:47][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 12:06:47][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 12:06:47][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 12:06:47][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/10/2017 12:06:47][                        Main()] Calling ConnectToTargetCompany()
[08/10/2017 12:06:47][      ConnectToTargetCompany()] Starting function
[08/10/2017 12:06:47][      ConnectToTargetCompany()] Initializing the Company Object
[08/10/2017 12:06:51][      ConnectToTargetCompany()] Assigning the representing database name
[08/10/2017 12:06:51][      ConnectToTargetCompany()] Connecting to the Company Database.  UAT_HSukiGroup
[08/10/2017 12:07:04][      ConnectToTargetCompany()] Completed with SUCCESS
[08/10/2017 12:07:04][                        Main()] Calling IntegrityValidation()
[08/10/2017 12:07:04][         IntegrityValidation()] Starting Function
[08/10/2017 12:07:04][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/10/2017 12:07:04][     MarketingDocuments_Sync()] Starting Function 
[08/10/2017 12:07:04][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/10/2017 12:07:04][          AR_InvoiceCreation()] Starting Function 
[08/10/2017 12:07:38][          AR_InvoiceCreation()] Attempting to Add Draft 
[08/10/2017 12:13:09][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/10/2017 12:13:09][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 12:13:09][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 12:13:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 12:13:09][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/10/2017 12:13:09][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 12:13:09][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 12:13:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 12:13:09][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/10/2017 12:13:09][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 12:13:09][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 12:13:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 12:13:09][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/10/2017 12:13:09][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 12:13:09][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 12:13:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 12:13:09][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/10/2017 12:13:09][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 12:13:09][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 12:13:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 12:13:09][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/10/2017 12:13:09][                        Main()] Calling ConnectToTargetCompany()
[08/10/2017 12:13:09][      ConnectToTargetCompany()] Starting function
[08/10/2017 12:13:09][      ConnectToTargetCompany()] Initializing the Company Object
[08/10/2017 12:13:13][      ConnectToTargetCompany()] Assigning the representing database name
[08/10/2017 12:13:13][      ConnectToTargetCompany()] Connecting to the Company Database.  UAT_HSukiGroup
[08/10/2017 12:13:26][      ConnectToTargetCompany()] Completed with SUCCESS
[08/10/2017 12:13:26][                        Main()] Calling IntegrityValidation()
[08/10/2017 12:13:26][         IntegrityValidation()] Starting Function
[08/10/2017 12:13:26][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/10/2017 12:13:26][     MarketingDocuments_Sync()] Starting Function 
[08/10/2017 12:13:26][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/10/2017 12:13:26][          AR_InvoiceCreation()] Starting Function 
[08/10/2017 12:13:26][          AR_InvoiceCreation()] Attempting to Add Draft 
[08/10/2017 12:17:25][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/10/2017 12:17:25][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 12:17:25][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 12:17:26][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 12:17:26][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/10/2017 12:17:26][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 12:17:26][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 12:17:26][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 12:17:26][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/10/2017 12:17:26][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 12:17:26][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 12:17:26][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 12:17:26][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/10/2017 12:17:26][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 12:17:26][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 12:17:26][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 12:17:26][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/10/2017 12:17:26][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/10/2017 12:17:26][          ExecuteSQLQuery_DT()] Starting function
[08/10/2017 12:17:26][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/10/2017 12:17:26][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/10/2017 12:17:26][                        Main()] Calling ConnectToTargetCompany()
[08/10/2017 12:17:26][      ConnectToTargetCompany()] Starting function
[08/10/2017 12:17:26][      ConnectToTargetCompany()] Initializing the Company Object
[08/10/2017 12:17:29][      ConnectToTargetCompany()] Assigning the representing database name
[08/10/2017 12:17:29][      ConnectToTargetCompany()] Connecting to the Company Database.  UAT_HSukiGroup
[08/10/2017 12:17:43][      ConnectToTargetCompany()] Completed with SUCCESS
[08/10/2017 12:17:43][                        Main()] Calling IntegrityValidation()
[08/10/2017 12:17:43][         IntegrityValidation()] Starting Function
[08/10/2017 12:17:43][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/10/2017 12:17:43][     MarketingDocuments_Sync()] Starting Function 
[08/10/2017 12:17:43][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/10/2017 12:17:43][          AR_InvoiceCreation()] Starting Function 
[08/10/2017 12:17:43][          AR_InvoiceCreation()] Attempting to Add Draft 
[08/11/2017 00:16:51][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/11/2017 00:16:51][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 00:16:51][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 00:16:52][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 00:16:52][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/11/2017 00:16:52][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 00:16:52][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 00:16:52][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 00:16:52][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/11/2017 00:16:52][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 00:16:52][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 00:16:52][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 00:16:52][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/11/2017 00:16:52][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 00:16:52][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 00:16:52][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 00:16:52][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/11/2017 00:16:52][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 00:16:52][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 00:16:52][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 00:16:52][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/11/2017 00:16:52][                        Main()] Calling ConnectToTargetCompany()
[08/11/2017 00:16:52][      ConnectToTargetCompany()] Starting function
[08/11/2017 00:16:52][      ConnectToTargetCompany()] Initializing the Company Object
[08/11/2017 00:16:56][      ConnectToTargetCompany()] Assigning the representing database name
[08/11/2017 00:16:56][      ConnectToTargetCompany()] Connecting to the Company Database.  UAT_HSukiGroup
[08/11/2017 00:17:10][      ConnectToTargetCompany()] Completed with SUCCESS
[08/11/2017 00:17:10][                        Main()] Calling IntegrityValidation()
[08/11/2017 00:17:10][         IntegrityValidation()] Starting Function
[08/11/2017 00:17:10][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/11/2017 00:17:10][     MarketingDocuments_Sync()] Starting Function 
[08/11/2017 00:17:10][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/11/2017 00:17:10][          AR_InvoiceCreation()] Starting Function 
[08/11/2017 00:17:10][          AR_InvoiceCreation()] Attempting to Add Draft 
[08/11/2017 00:19:46][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/11/2017 00:19:46][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 00:19:46][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 00:19:46][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 00:19:46][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/11/2017 00:19:46][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 00:19:46][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 00:19:47][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 00:19:47][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/11/2017 00:19:47][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 00:19:47][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 00:19:47][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 00:19:47][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/11/2017 00:19:47][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 00:19:47][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 00:19:47][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 00:19:47][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/11/2017 00:19:47][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 00:19:47][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 00:19:47][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 00:19:47][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/11/2017 00:19:47][                        Main()] Calling ConnectToTargetCompany()
[08/11/2017 00:19:47][      ConnectToTargetCompany()] Starting function
[08/11/2017 00:19:47][      ConnectToTargetCompany()] Initializing the Company Object
[08/11/2017 00:19:50][      ConnectToTargetCompany()] Assigning the representing database name
[08/11/2017 00:19:50][      ConnectToTargetCompany()] Connecting to the Company Database.  UAT_HSukiGroup
[08/11/2017 00:20:03][      ConnectToTargetCompany()] Completed with SUCCESS
[08/11/2017 00:20:03][                        Main()] Calling IntegrityValidation()
[08/11/2017 00:20:03][         IntegrityValidation()] Starting Function
[08/11/2017 00:20:03][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/11/2017 00:20:03][     MarketingDocuments_Sync()] Starting Function 
[08/11/2017 00:20:03][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/11/2017 00:20:04][          AR_InvoiceCreation()] Starting Function 
[08/11/2017 00:20:04][          AR_InvoiceCreation()] Attempting to Add Draft 
[08/11/2017 08:30:29][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/11/2017 08:30:29][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 08:30:29][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 08:30:30][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 08:30:30][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/11/2017 08:30:30][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 08:30:30][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 08:30:30][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 08:30:30][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/11/2017 08:30:30][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 08:30:30][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 08:30:30][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 08:30:30][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/11/2017 08:30:30][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 08:30:30][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 08:30:30][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 08:30:30][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/11/2017 08:30:30][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 08:30:30][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 08:30:30][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 08:30:30][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/11/2017 08:30:30][                        Main()] Calling ConnectToTargetCompany()
[08/11/2017 08:30:30][      ConnectToTargetCompany()] Starting function
[08/11/2017 08:30:30][      ConnectToTargetCompany()] Initializing the Company Object
[08/11/2017 08:30:33][      ConnectToTargetCompany()] Assigning the representing database name
[08/11/2017 08:30:33][      ConnectToTargetCompany()] Connecting to the Company Database.  UAT_HSukiGroup
[08/11/2017 08:30:47][      ConnectToTargetCompany()] Completed with SUCCESS
[08/11/2017 08:30:47][                        Main()] Calling IntegrityValidation()
[08/11/2017 08:30:47][         IntegrityValidation()] Starting Function
[08/11/2017 08:30:47][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/11/2017 08:30:47][     MarketingDocuments_Sync()] Starting Function 
[08/11/2017 08:30:47][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/11/2017 08:32:25][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/11/2017 08:32:25][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 08:32:25][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 08:32:26][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 08:32:26][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/11/2017 08:32:26][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 08:32:26][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 08:32:26][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 08:32:26][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/11/2017 08:32:26][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 08:32:26][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 08:32:26][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 08:32:26][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/11/2017 08:32:26][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 08:32:26][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 08:32:26][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 08:32:26][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/11/2017 08:32:26][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 08:32:26][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 08:32:26][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 08:32:26][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/11/2017 08:32:26][                        Main()] Calling ConnectToTargetCompany()
[08/11/2017 08:32:26][      ConnectToTargetCompany()] Starting function
[08/11/2017 08:32:26][      ConnectToTargetCompany()] Initializing the Company Object
[08/11/2017 08:32:29][      ConnectToTargetCompany()] Assigning the representing database name
[08/11/2017 08:32:29][      ConnectToTargetCompany()] Connecting to the Company Database.  UAT_HSukiGroup
[08/11/2017 08:32:41][      ConnectToTargetCompany()] Completed with SUCCESS
[08/11/2017 08:32:41][                        Main()] Calling IntegrityValidation()
[08/11/2017 08:32:41][         IntegrityValidation()] Starting Function
[08/11/2017 08:32:41][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/11/2017 08:32:41][     MarketingDocuments_Sync()] Starting Function 
[08/11/2017 08:32:41][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/11/2017 08:41:58][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/11/2017 08:41:58][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 08:41:58][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 08:41:58][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 08:41:58][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/11/2017 08:41:58][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 08:41:58][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 08:41:58][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 08:41:58][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/11/2017 08:41:58][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 08:41:58][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 08:41:58][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 08:41:58][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/11/2017 08:41:58][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 08:41:58][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 08:41:58][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 08:41:58][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/11/2017 08:41:58][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 08:41:58][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 08:41:58][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 08:41:58][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/11/2017 08:41:58][                        Main()] Calling ConnectToTargetCompany()
[08/11/2017 08:41:58][      ConnectToTargetCompany()] Starting function
[08/11/2017 08:41:58][      ConnectToTargetCompany()] Initializing the Company Object
[08/11/2017 08:42:02][      ConnectToTargetCompany()] Assigning the representing database name
[08/11/2017 08:42:02][      ConnectToTargetCompany()] Connecting to the Company Database.  UAT_HSukiGroup
[08/11/2017 08:42:15][      ConnectToTargetCompany()] Completed with SUCCESS
[08/11/2017 08:42:15][                        Main()] Calling IntegrityValidation()
[08/11/2017 08:42:15][         IntegrityValidation()] Starting Function
[08/11/2017 08:42:15][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/11/2017 08:42:15][     MarketingDocuments_Sync()] Starting Function 
[08/11/2017 08:42:15][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/11/2017 09:14:08][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/11/2017 09:14:08][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 09:14:08][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 09:14:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 09:14:09][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/11/2017 09:14:09][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 09:14:09][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 09:14:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 09:14:09][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/11/2017 09:14:09][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 09:14:09][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 09:14:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 09:14:09][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/11/2017 09:14:09][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 09:14:09][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 09:14:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 09:14:09][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/11/2017 09:14:09][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 09:14:09][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 09:14:09][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 09:14:09][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/11/2017 09:14:09][                        Main()] Calling ConnectToTargetCompany()
[08/11/2017 09:14:09][      ConnectToTargetCompany()] Starting function
[08/11/2017 09:14:09][      ConnectToTargetCompany()] Initializing the Company Object
[08/11/2017 09:14:13][      ConnectToTargetCompany()] Assigning the representing database name
[08/11/2017 09:14:13][      ConnectToTargetCompany()] Connecting to the Company Database.  UAT_HSukiGroup
[08/11/2017 09:14:26][      ConnectToTargetCompany()] Completed with SUCCESS
[08/11/2017 09:14:26][                        Main()] Calling IntegrityValidation()
[08/11/2017 09:14:26][         IntegrityValidation()] Starting Function
[08/11/2017 09:14:26][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/11/2017 09:14:26][     MarketingDocuments_Sync()] Starting Function 
[08/11/2017 09:14:26][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/11/2017 09:14:35][          AR_InvoiceCreation()] Starting Function 
[08/11/2017 09:15:06][     MarketingDocuments_Sync()] Rollback the SAP Transaction 
[08/11/2017 09:15:44][     MarketingDocuments_Sync()] Date Time 8/11/2017 9:14 AM
[08/11/2017 09:24:43][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/11/2017 09:24:43][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 09:24:43][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 09:24:43][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 09:24:43][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/11/2017 09:24:43][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 09:24:43][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 09:24:43][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 09:24:43][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/11/2017 09:24:43][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 09:24:43][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 09:24:43][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 09:24:43][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/11/2017 09:24:43][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 09:24:43][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 09:24:43][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 09:24:43][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/11/2017 09:24:43][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 09:24:43][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 09:24:44][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 09:24:44][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/11/2017 09:24:44][                        Main()] Calling ConnectToTargetCompany()
[08/11/2017 09:24:44][      ConnectToTargetCompany()] Starting function
[08/11/2017 09:24:44][      ConnectToTargetCompany()] Initializing the Company Object
[08/11/2017 09:24:47][      ConnectToTargetCompany()] Assigning the representing database name
[08/11/2017 09:24:47][      ConnectToTargetCompany()] Connecting to the Company Database.  UAT_HSukiGroup
[08/11/2017 09:25:01][      ConnectToTargetCompany()] Completed with SUCCESS
[08/11/2017 09:25:01][                        Main()] Calling IntegrityValidation()
[08/11/2017 09:25:01][         IntegrityValidation()] Starting Function
[08/11/2017 09:25:17][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/11/2017 09:27:37][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/11/2017 09:27:37][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 09:27:37][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 09:27:37][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 09:27:37][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/11/2017 09:27:37][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 09:27:37][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 09:27:37][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 09:27:37][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/11/2017 09:27:37][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 09:27:37][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 09:27:37][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 09:27:37][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/11/2017 09:27:37][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 09:27:37][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 09:27:37][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 09:27:37][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/11/2017 09:27:37][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/11/2017 09:27:37][          ExecuteSQLQuery_DT()] Starting function
[08/11/2017 09:27:37][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/11/2017 09:27:37][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/11/2017 09:27:37][                        Main()] Calling ConnectToTargetCompany()
[08/11/2017 09:27:37][      ConnectToTargetCompany()] Starting function
[08/11/2017 09:27:37][      ConnectToTargetCompany()] Initializing the Company Object
[08/11/2017 09:27:41][      ConnectToTargetCompany()] Assigning the representing database name
[08/11/2017 09:27:41][      ConnectToTargetCompany()] Connecting to the Company Database.  UAT_HSukiGroup
[08/11/2017 09:27:55][      ConnectToTargetCompany()] Completed with SUCCESS
[08/11/2017 09:27:55][                        Main()] Calling IntegrityValidation()
[08/11/2017 09:27:55][         IntegrityValidation()] Starting Function
[08/14/2017 12:40:32][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/14/2017 12:40:32][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/14/2017 12:40:32][          ExecuteSQLQuery_DT()] Starting function
[08/14/2017 12:40:32][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/14/2017 12:40:32][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/14/2017 12:40:32][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/14/2017 12:40:32][          ExecuteSQLQuery_DT()] Starting function
[08/14/2017 12:40:32][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/14/2017 12:40:32][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/14/2017 12:40:32][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/14/2017 12:40:32][          ExecuteSQLQuery_DT()] Starting function
[08/14/2017 12:40:32][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/14/2017 12:40:32][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/14/2017 12:40:32][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/14/2017 12:40:32][          ExecuteSQLQuery_DT()] Starting function
[08/14/2017 12:40:32][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/14/2017 12:40:32][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/14/2017 12:40:32][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/14/2017 12:40:32][          ExecuteSQLQuery_DT()] Starting function
[08/14/2017 12:40:32][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/14/2017 12:40:32][      GetSystemIntializeInfo()] Item Group : SELECT T0.[NumAtCard], T0.[DocNum] FROM [UAT_HSukiGroup].. OINV T0
[08/14/2017 12:40:32][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/14/2017 12:40:32][          ExecuteSQLQuery_DT()] Starting function
[08/14/2017 12:40:32][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/14/2017 12:40:32][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/14/2017 12:40:32][                        Main()] Calling ConnectToTargetCompany()
[08/14/2017 12:40:32][      ConnectToTargetCompany()] Starting function
[08/14/2017 12:40:32][      ConnectToTargetCompany()] Initializing the Company Object
[08/14/2017 12:40:36][      ConnectToTargetCompany()] Assigning the representing database name
[08/14/2017 12:40:36][      ConnectToTargetCompany()] Connecting to the Company Database.  UAT_HSukiGroup
[08/14/2017 12:40:49][      ConnectToTargetCompany()] Completed with SUCCESS
[08/14/2017 12:40:49][                        Main()] Calling IntegrityValidation()
[08/14/2017 12:40:49][         IntegrityValidation()] Starting Function
[08/14/2017 12:41:56][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/14/2017 12:41:56][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/14/2017 12:41:56][          ExecuteSQLQuery_DT()] Starting function
[08/14/2017 12:41:56][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/14/2017 12:41:56][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_HSukiGroup] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/14/2017 12:41:56][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/14/2017 12:41:56][          ExecuteSQLQuery_DT()] Starting function
[08/14/2017 12:41:56][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/14/2017 12:41:56][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_HSukiGroup] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/14/2017 12:41:56][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/14/2017 12:41:56][          ExecuteSQLQuery_DT()] Starting function
[08/14/2017 12:41:56][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/14/2017 12:41:56][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_HSukiGroup].. OWHS T0
[08/14/2017 12:41:56][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/14/2017 12:41:56][          ExecuteSQLQuery_DT()] Starting function
[08/14/2017 12:41:56][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/14/2017 12:41:56][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_HSukiGroup].. OITB T0  INNER JOIN [UAT_HSukiGroup].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/14/2017 12:41:56][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/14/2017 12:41:56][          ExecuteSQLQuery_DT()] Starting function
[08/14/2017 12:41:56][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/14/2017 12:41:56][      GetSystemIntializeInfo()] Item Group : SELECT T0.[NumAtCard], T0.[DocNum] FROM [UAT_HSukiGroup].. OINV T0
[08/14/2017 12:41:56][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/14/2017 12:41:56][          ExecuteSQLQuery_DT()] Starting function
[08/14/2017 12:41:57][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/14/2017 12:41:57][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/14/2017 12:41:57][                        Main()] Calling ConnectToTargetCompany()
[08/14/2017 12:41:57][      ConnectToTargetCompany()] Starting function
[08/14/2017 12:41:57][      ConnectToTargetCompany()] Initializing the Company Object
[08/14/2017 12:42:00][      ConnectToTargetCompany()] Assigning the representing database name
[08/14/2017 12:42:00][      ConnectToTargetCompany()] Connecting to the Company Database.  UAT_HSukiGroup
[08/14/2017 12:42:14][      ConnectToTargetCompany()] Completed with SUCCESS
[08/14/2017 12:42:14][                        Main()] Calling IntegrityValidation()
[08/14/2017 12:42:14][         IntegrityValidation()] Starting Function
[08/14/2017 12:46:04][         IntegrityValidation()] Validation Update SQL UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = '11JKC180717199010101 - File ID already exists in AR Invoice 10000917' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC180717199010101' and [POSSyncCompletionStatus]=1
[08/14/2017 12:46:04][         IntegrityValidation()] Calling Function ExecuteSQLQuery_DT() 
[08/14/2017 12:46:05][          ExecuteSQLQuery_DT()] Starting function
[08/14/2017 12:46:05][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:12:24][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/16/2017 17:12:24][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:12:24][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:12:26][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:12:26][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_RIshiMura] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/16/2017 17:12:26][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:12:26][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:12:29][          ExecuteSQLQuery_DT()] Completed with ERROR
[08/16/2017 17:12:29][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_RIshiMura] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/16/2017 17:12:29][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:12:29][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:12:29][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:12:29][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_RIshiMura].. OWHS T0
[08/16/2017 17:12:29][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:12:29][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:12:29][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:12:29][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_RIshiMura].. OITB T0  INNER JOIN [UAT_RIshiMura].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/16/2017 17:12:29][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:12:29][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:12:30][          ExecuteSQLQuery_DT()] Completed with ERROR
[08/16/2017 17:12:30][      GetSystemIntializeInfo()] Item Group : SELECT T0.[NumAtCard], T0.[DocNum] FROM [UAT_RIshiMura].. OINV T0
[08/16/2017 17:12:30][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:12:30][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:12:30][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:12:30][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/16/2017 17:12:39][                        Main()] Calling ConnectToTargetCompany()
[08/16/2017 17:12:40][      ConnectToTargetCompany()] Starting function
[08/16/2017 17:12:40][      ConnectToTargetCompany()] Initializing the Company Object
[08/16/2017 17:12:51][      ConnectToTargetCompany()] Assigning the representing database name
[08/16/2017 17:12:51][      ConnectToTargetCompany()] Connecting to the Company Database.  UAT_RIshiMura
[08/16/2017 17:13:45][      ConnectToTargetCompany()] Completed with SUCCESS
[08/16/2017 17:15:06][                        Main()] Calling IntegrityValidation()
[08/16/2017 17:16:00][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/16/2017 17:16:00][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:16:00][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:16:00][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:16:00][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate], [OITM].[ItemCode] [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] left join [UAT_RIshiMura] ..[OITM] on [SalesTransDetails].[POSItemCode] COLLATE SQL_Latin1_General_CP850_CI_AS = [OITM].[U_RAPTOR_CODE]  where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/16/2017 17:16:00][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:16:00][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:16:01][          ExecuteSQLQuery_DT()] Completed with ERROR
[08/16/2017 17:16:01][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_RIshiMura] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/16/2017 17:16:01][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:16:01][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:16:01][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:16:01][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_RIshiMura].. OWHS T0
[08/16/2017 17:16:01][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:16:01][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:16:01][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:16:01][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_RIshiMura].. OITB T0  INNER JOIN [UAT_RIshiMura].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/16/2017 17:16:01][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:16:01][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:16:01][          ExecuteSQLQuery_DT()] Completed with ERROR
[08/16/2017 17:16:01][      GetSystemIntializeInfo()] Item Group : SELECT T0.[NumAtCard], T0.[DocNum] FROM [UAT_RIshiMura].. OINV T0
[08/16/2017 17:16:01][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:16:01][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:16:01][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:16:01][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/16/2017 17:16:01][                        Main()] Calling ConnectToTargetCompany()
[08/16/2017 17:16:01][      ConnectToTargetCompany()] Starting function
[08/16/2017 17:16:01][      ConnectToTargetCompany()] Initializing the Company Object
[08/16/2017 17:16:04][      ConnectToTargetCompany()] Assigning the representing database name
[08/16/2017 17:16:04][      ConnectToTargetCompany()] Connecting to the Company Database.  UAT_RIshiMura
[08/16/2017 17:16:17][      ConnectToTargetCompany()] Completed with SUCCESS
[08/16/2017 17:16:17][                        Main()] Calling IntegrityValidation()
[08/16/2017 17:20:06][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/16/2017 17:20:07][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:20:08][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:20:08][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:20:13][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate],  [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/16/2017 17:20:14][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:20:15][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:20:15][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:20:47][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_RIshiMura] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/16/2017 17:20:48][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:20:48][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:20:48][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:20:50][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_RIshiMura].. OWHS T0
[08/16/2017 17:20:50][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:20:51][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:20:51][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:20:52][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_RIshiMura].. OITB T0  INNER JOIN [UAT_RIshiMura].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/16/2017 17:20:54][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:20:54][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:20:54][          ExecuteSQLQuery_DT()] Completed with ERROR
[08/16/2017 17:20:55][      GetSystemIntializeInfo()] Item Group : SELECT T0.[NumAtCard], T0.[DocNum] FROM [UAT_RIshiMura].. OINV T0
[08/16/2017 17:20:56][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:20:56][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:20:56][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:20:58][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/16/2017 17:21:03][                        Main()] Calling ConnectToTargetCompany()
[08/16/2017 17:21:04][      ConnectToTargetCompany()] Starting function
[08/16/2017 17:21:04][      ConnectToTargetCompany()] Initializing the Company Object
[08/16/2017 17:21:08][      ConnectToTargetCompany()] Assigning the representing database name
[08/16/2017 17:21:08][      ConnectToTargetCompany()] Connecting to the Company Database.  UAT_RIshiMura
[08/16/2017 17:21:21][      ConnectToTargetCompany()] Completed with SUCCESS
[08/16/2017 17:21:38][                        Main()] Calling IntegrityValidation()
[08/16/2017 17:21:47][         IntegrityValidation()] Starting Function
[08/16/2017 17:23:28][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC010817213010101
[08/16/2017 17:25:50][     MarketingDocuments_Sync()] Starting Function 
[08/16/2017 17:26:08][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/16/2017 17:27:34][          AR_InvoiceCreation()] Starting Function 
[08/16/2017 17:29:40][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/16/2017 17:29:40][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:29:40][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:29:40][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:29:40][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate],  [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/16/2017 17:29:40][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:29:40][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:29:41][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:29:41][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_RIshiMura] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/16/2017 17:29:41][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:29:41][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:29:41][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:29:41][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_RIshiMura].. OWHS T0
[08/16/2017 17:29:41][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:29:41][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:29:41][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:29:41][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_RIshiMura].. OITB T0  INNER JOIN [UAT_RIshiMura].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/16/2017 17:29:41][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:29:41][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:29:41][          ExecuteSQLQuery_DT()] Completed with ERROR
[08/16/2017 17:29:41][      GetSystemIntializeInfo()] Item Group : SELECT T0.[NumAtCard], T0.[DocNum] FROM [UAT_RIshiMura].. OINV T0
[08/16/2017 17:29:41][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:29:41][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:29:41][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:29:41][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/16/2017 17:29:41][                        Main()] Calling ConnectToTargetCompany()
[08/16/2017 17:29:41][      ConnectToTargetCompany()] Starting function
[08/16/2017 17:29:41][      ConnectToTargetCompany()] Initializing the Company Object
[08/16/2017 17:29:45][      ConnectToTargetCompany()] Assigning the representing database name
[08/16/2017 17:29:45][      ConnectToTargetCompany()] Connecting to the Company Database.  UAT_RIshiMura
[08/16/2017 17:29:58][      ConnectToTargetCompany()] Completed with SUCCESS
[08/16/2017 17:29:58][                        Main()] Calling IntegrityValidation()
[08/16/2017 17:30:10][         IntegrityValidation()] Starting Function
[08/16/2017 17:30:10][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC010817213010101
[08/16/2017 17:30:10][         IntegrityValidation()] Validation Update SQL UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC010817213010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC010817213010101' and [POSSyncCompletionStatus]=1
[08/16/2017 17:30:10][         IntegrityValidation()] Calling Function ExecuteSQLQuery_DT() 
[08/16/2017 17:30:10][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:30:10][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:30:10][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC020817214010101
[08/16/2017 17:30:10][         IntegrityValidation()] Validation Update SQL UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC010817213010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC010817213010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC020817214010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC020817214010101' and [POSSyncCompletionStatus]=1
[08/16/2017 17:30:10][         IntegrityValidation()] Calling Function ExecuteSQLQuery_DT() 
[08/16/2017 17:30:10][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:30:10][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:30:10][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC030817215010101
[08/16/2017 17:30:10][         IntegrityValidation()] Validation Update SQL UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC010817213010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC010817213010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC020817214010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC020817214010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC030817215010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC030817215010101' and [POSSyncCompletionStatus]=1
[08/16/2017 17:30:10][         IntegrityValidation()] Calling Function ExecuteSQLQuery_DT() 
[08/16/2017 17:30:10][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:30:10][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:30:10][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC040817216010101
[08/16/2017 17:30:10][         IntegrityValidation()] Validation Update SQL UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC010817213010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC010817213010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC020817214010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC020817214010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC030817215010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC030817215010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC040817216010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC040817216010101' and [POSSyncCompletionStatus]=1
[08/16/2017 17:30:10][         IntegrityValidation()] Calling Function ExecuteSQLQuery_DT() 
[08/16/2017 17:30:10][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:30:11][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:30:11][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC050817217010101
[08/16/2017 17:30:11][         IntegrityValidation()] Validation Update SQL UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC010817213010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC010817213010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC020817214010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC020817214010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC030817215010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC030817215010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC040817216010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC040817216010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC050817217010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC050817217010101' and [POSSyncCompletionStatus]=1
[08/16/2017 17:30:11][         IntegrityValidation()] Calling Function ExecuteSQLQuery_DT() 
[08/16/2017 17:30:11][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:30:11][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:30:11][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC060817218010101
[08/16/2017 17:30:11][     MarketingDocuments_Sync()] Starting Function 
[08/16/2017 17:30:11][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/16/2017 17:30:11][          AR_InvoiceCreation()] Starting Function 
[08/16/2017 17:30:11][          AR_InvoiceCreation()] Completed with ERROR
[08/16/2017 17:30:11][          AR_InvoiceCreation()] Rollback the SAP Transaction 
[08/16/2017 17:30:11][     MarketingDocuments_Sync()] Completed with ERROR
[08/16/2017 17:30:11][     MarketingDocuments_Sync()] Rollback the SAP Transaction 
[08/16/2017 17:30:11][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC170717198010101
[08/16/2017 17:30:11][         IntegrityValidation()] Validation Update SQL UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC010817213010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC010817213010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC020817214010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC020817214010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC030817215010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC030817215010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC040817216010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC040817216010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC050817217010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC050817217010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC170717198010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC170717198010101' and [POSSyncCompletionStatus]=1
[08/16/2017 17:30:11][         IntegrityValidation()] Calling Function ExecuteSQLQuery_DT() 
[08/16/2017 17:30:11][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:30:11][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:30:11][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC180717199010101
[08/16/2017 17:30:11][         IntegrityValidation()] Validation Update SQL UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC010817213010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC010817213010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC020817214010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC020817214010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC030817215010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC030817215010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC040817216010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC040817216010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC050817217010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC050817217010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC170717198010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC170717198010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC180717199010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC180717199010101' and [POSSyncCompletionStatus]=1
[08/16/2017 17:30:11][         IntegrityValidation()] Calling Function ExecuteSQLQuery_DT() 
[08/16/2017 17:30:11][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:30:11][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:30:11][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC190717200010101
[08/16/2017 17:30:11][         IntegrityValidation()] Validation Update SQL UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC010817213010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC010817213010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC020817214010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC020817214010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC030817215010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC030817215010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC040817216010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC040817216010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC050817217010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC050817217010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC170717198010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC170717198010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC180717199010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC180717199010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC190717200010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC190717200010101' and [POSSyncCompletionStatus]=1
[08/16/2017 17:30:11][         IntegrityValidation()] Calling Function ExecuteSQLQuery_DT() 
[08/16/2017 17:30:11][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:30:11][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:30:11][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC200717201010101
[08/16/2017 17:30:11][         IntegrityValidation()] Validation Update SQL UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC010817213010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC010817213010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC020817214010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC020817214010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC030817215010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC030817215010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC040817216010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC040817216010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC050817217010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC050817217010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC170717198010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC170717198010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC180717199010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC180717199010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC190717200010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC190717200010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC200717201010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC200717201010101' and [POSSyncCompletionStatus]=1
[08/16/2017 17:30:11][         IntegrityValidation()] Calling Function ExecuteSQLQuery_DT() 
[08/16/2017 17:30:11][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:30:11][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:30:11][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC210717202010101
[08/16/2017 17:30:11][         IntegrityValidation()] Validation Update SQL UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC010817213010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC010817213010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC020817214010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC020817214010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC030817215010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC030817215010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC040817216010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC040817216010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC050817217010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC050817217010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC170717198010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC170717198010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC180717199010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC180717199010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC190717200010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC190717200010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC200717201010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC200717201010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC210717202010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC210717202010101' and [POSSyncCompletionStatus]=1
[08/16/2017 17:30:11][         IntegrityValidation()] Calling Function ExecuteSQLQuery_DT() 
[08/16/2017 17:30:11][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:30:11][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:30:11][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC220717203010101
[08/16/2017 17:30:11][         IntegrityValidation()] Validation Update SQL UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC010817213010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC010817213010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC020817214010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC020817214010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC030817215010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC030817215010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC040817216010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC040817216010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC050817217010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC050817217010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC170717198010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC170717198010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC180717199010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC180717199010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC190717200010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC190717200010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC200717201010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC200717201010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC210717202010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC210717202010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC220717203010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC220717203010101' and [POSSyncCompletionStatus]=1
[08/16/2017 17:30:11][         IntegrityValidation()] Calling Function ExecuteSQLQuery_DT() 
[08/16/2017 17:30:11][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:30:12][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:30:12][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC230717204010101
[08/16/2017 17:30:12][     MarketingDocuments_Sync()] Starting Function 
[08/16/2017 17:30:12][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/16/2017 17:30:12][          AR_InvoiceCreation()] Starting Function 
[08/16/2017 17:30:12][          AR_InvoiceCreation()] Completed with ERROR
[08/16/2017 17:30:12][          AR_InvoiceCreation()] Rollback the SAP Transaction 
[08/16/2017 17:30:12][     MarketingDocuments_Sync()] Completed with ERROR
[08/16/2017 17:30:12][     MarketingDocuments_Sync()] Rollback the SAP Transaction 
[08/16/2017 17:30:12][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC240717205010101
[08/16/2017 17:30:12][         IntegrityValidation()] Validation Update SQL UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC010817213010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC010817213010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC020817214010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC020817214010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC030817215010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC030817215010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC040817216010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC040817216010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC050817217010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC050817217010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC170717198010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC170717198010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC180717199010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC180717199010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC190717200010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC190717200010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC200717201010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC200717201010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC210717202010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC210717202010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC220717203010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC220717203010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC240717205010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC240717205010101' and [POSSyncCompletionStatus]=1
[08/16/2017 17:30:12][         IntegrityValidation()] Calling Function ExecuteSQLQuery_DT() 
[08/16/2017 17:30:12][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:30:12][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:30:12][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC250717206010101
[08/16/2017 17:30:12][         IntegrityValidation()] Validation Update SQL UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC010817213010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC010817213010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC020817214010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC020817214010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC030817215010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC030817215010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC040817216010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC040817216010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC050817217010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC050817217010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC170717198010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC170717198010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC180717199010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC180717199010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC190717200010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC190717200010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC200717201010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC200717201010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC210717202010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC210717202010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC220717203010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC220717203010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC240717205010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC240717205010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC250717206010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC250717206010101' and [POSSyncCompletionStatus]=1
[08/16/2017 17:30:12][         IntegrityValidation()] Calling Function ExecuteSQLQuery_DT() 
[08/16/2017 17:30:12][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:30:12][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:30:12][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC260717207010101
[08/16/2017 17:30:12][         IntegrityValidation()] Validation Update SQL UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC010817213010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC010817213010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC020817214010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC020817214010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC030817215010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC030817215010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC040817216010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC040817216010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC050817217010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC050817217010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC170717198010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC170717198010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC180717199010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC180717199010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC190717200010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC190717200010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC200717201010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC200717201010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC210717202010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC210717202010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC220717203010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC220717203010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC240717205010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC240717205010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC250717206010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC250717206010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC260717207010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC260717207010101' and [POSSyncCompletionStatus]=1
[08/16/2017 17:30:12][         IntegrityValidation()] Calling Function ExecuteSQLQuery_DT() 
[08/16/2017 17:30:12][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:30:12][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:30:12][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC270717208010101
[08/16/2017 17:30:12][         IntegrityValidation()] Validation Update SQL UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC010817213010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC010817213010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC020817214010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC020817214010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC030817215010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC030817215010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC040817216010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC040817216010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC050817217010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC050817217010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC170717198010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC170717198010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC180717199010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC180717199010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC190717200010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC190717200010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC200717201010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC200717201010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC210717202010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC210717202010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC220717203010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC220717203010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC240717205010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC240717205010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC250717206010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC250717206010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC260717207010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC260717207010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC270717208010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC270717208010101' and [POSSyncCompletionStatus]=1
[08/16/2017 17:30:12][         IntegrityValidation()] Calling Function ExecuteSQLQuery_DT() 
[08/16/2017 17:30:12][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:30:12][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:30:12][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC280717209010101
[08/16/2017 17:30:12][         IntegrityValidation()] Validation Update SQL UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC010817213010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC010817213010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC020817214010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC020817214010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC030817215010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC030817215010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC040817216010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC040817216010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC050817217010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC050817217010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC170717198010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC170717198010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC180717199010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC180717199010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC190717200010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC190717200010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC200717201010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC200717201010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC210717202010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC210717202010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC220717203010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC220717203010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC240717205010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC240717205010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC250717206010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC250717206010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC260717207010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC260717207010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC270717208010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC270717208010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC280717209010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC280717209010101' and [POSSyncCompletionStatus]=1
[08/16/2017 17:30:12][         IntegrityValidation()] Calling Function ExecuteSQLQuery_DT() 
[08/16/2017 17:30:12][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:30:12][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:30:12][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC290717210010101
[08/16/2017 17:30:12][         IntegrityValidation()] Validation Update SQL UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC010817213010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC010817213010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC020817214010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC020817214010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC030817215010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC030817215010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC040817216010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC040817216010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC050817217010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC050817217010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC170717198010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC170717198010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC180717199010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC180717199010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC190717200010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC190717200010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC200717201010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC200717201010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC210717202010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC210717202010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC220717203010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC220717203010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC240717205010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC240717205010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC250717206010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC250717206010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC260717207010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC260717207010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC270717208010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC270717208010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC280717209010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC280717209010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC290717210010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC290717210010101' and [POSSyncCompletionStatus]=1
[08/16/2017 17:30:12][         IntegrityValidation()] Calling Function ExecuteSQLQuery_DT() 
[08/16/2017 17:30:12][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:30:12][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:30:12][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC300717211010101
[08/16/2017 17:30:12][     MarketingDocuments_Sync()] Starting Function 
[08/16/2017 17:30:12][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/16/2017 17:30:12][          AR_InvoiceCreation()] Starting Function 
[08/16/2017 17:30:12][          AR_InvoiceCreation()] Completed with ERROR
[08/16/2017 17:30:12][          AR_InvoiceCreation()] Rollback the SAP Transaction 
[08/16/2017 17:30:12][     MarketingDocuments_Sync()] Completed with ERROR
[08/16/2017 17:30:12][     MarketingDocuments_Sync()] Rollback the SAP Transaction 
[08/16/2017 17:30:12][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC310717212010101
[08/16/2017 17:30:12][         IntegrityValidation()] Validation Update SQL UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC010817213010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC010817213010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC020817214010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC020817214010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC030817215010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC030817215010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC040817216010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC040817216010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC050817217010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC050817217010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC170717198010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC170717198010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC180717199010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC180717199010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC190717200010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC190717200010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC200717201010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC200717201010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC210717202010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC210717202010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC220717203010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC220717203010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC240717205010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC240717205010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC250717206010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC250717206010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC260717207010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC260717207010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC270717208010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC270717208010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC280717209010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC280717209010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC290717210010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC290717210010101' and [POSSyncCompletionStatus]=1UPDATE [SalesTransHeader]SET [SAPSyncFileStatus] = 'FAIL' ,[SAPSyncErrMsg] = 'Credit Cards are not mapped in SAP B1 for File ID 11JKC310717212010101' , [ERRDateTime] = GETDATE() WHERE [FileID] = '11JKC310717212010101' and [POSSyncCompletionStatus]=1
[08/16/2017 17:30:12][         IntegrityValidation()] Calling Function ExecuteSQLQuery_DT() 
[08/16/2017 17:30:12][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:30:12][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:30:12][         IntegrityValidation()] Completed with SUCCESS 
[08/16/2017 17:30:12][                        Main()] Completed with SUCCESS
[08/16/2017 17:30:43][      GetSystemIntializeInfo()] Fetching INT DB SalesTransHeader Query : SELECT [SeqID] ,[FileID] ,[Outlet] , CONVERT( NVARCHAR(20), [DocDate],112) [DocDate],[TotalGrossAmt],[SvcCharge],[GST],[Rounding],[Excess],[Tips],[Covers],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS' 
[08/16/2017 17:30:43][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:30:43][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:30:43][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:30:43][      GetSystemIntializeInfo()] Fetching INT DB SalesTransDetails Query : SELECT [SeqID],[FileID],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate],  [POSItemCode],[Outlet],[Qty],[LineTotal],[DiscCode],[Disc],[SalesCategory],[POSSyncCompletionStatus]  FROM [dbo].[SalesTransDetails] where [FileID] in (SELECT [FileID] FROM [dbo].[SalesTransHeader] where [POSSyncCompletionStatus] = 1 and isnull([SAPSyncFileStatus],'')  <> 'SUCCESS') 
[08/16/2017 17:30:43][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:30:43][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:30:43][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:30:43][      GetSystemIntializeInfo()] Payment Query : SELECT  [SalesOutlet],CONVERT( NVARCHAR(20), [BusinessDate],112) [BusinessDate] ,T0.[PaymentCode],T1.CardName  ,[PaymentAmt],[BatchCode] ,[POSSyncCompletionStatus] ,[FileID]   FROM [CollectionDetails] T0 left join [UAT_RIshiMura] ..[ocrc] T1 ON T0.PaymentCode COLLATE SQL_Latin1_General_CP850_CI_AS = T1.CreditCard 
[08/16/2017 17:30:43][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:30:43][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:30:43][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:30:43][      GetSystemIntializeInfo()] Warehouse : SELECT T0.[WhsCode], T0.[WhsName] FROM [UAT_RIshiMura].. OWHS T0
[08/16/2017 17:30:43][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:30:43][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:30:43][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:30:43][      GetSystemIntializeInfo()] Item Group : SELECT T1.[ItemCode], T0.[U_CATER_SALES], T0.[U_CATER_COGS] FROM [UAT_RIshiMura].. OITB T0  INNER JOIN [UAT_RIshiMura].. OITM T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
[08/16/2017 17:30:43][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:30:43][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:30:43][          ExecuteSQLQuery_DT()] Completed with ERROR
[08/16/2017 17:30:43][      GetSystemIntializeInfo()] Item Group : SELECT T0.[NumAtCard], T0.[DocNum] FROM [UAT_RIshiMura].. OINV T0
[08/16/2017 17:30:43][      GetSystemIntializeInfo()] Calling ExecuteSQLQuery_DT()
[08/16/2017 17:30:43][          ExecuteSQLQuery_DT()] Starting function
[08/16/2017 17:30:43][          ExecuteSQLQuery_DT()] Completed with SUCCESS
[08/16/2017 17:30:43][      GetSystemIntializeInfo()] Completed with SUCCESS
[08/16/2017 17:30:43][                        Main()] Calling ConnectToTargetCompany()
[08/16/2017 17:30:43][      ConnectToTargetCompany()] Starting function
[08/16/2017 17:30:43][      ConnectToTargetCompany()] Initializing the Company Object
[08/16/2017 17:30:47][      ConnectToTargetCompany()] Assigning the representing database name
[08/16/2017 17:30:47][      ConnectToTargetCompany()] Connecting to the Company Database.  UAT_RIshiMura
[08/16/2017 17:31:00][      ConnectToTargetCompany()] Completed with SUCCESS
[08/16/2017 17:31:00][                        Main()] Calling IntegrityValidation()
[08/16/2017 17:31:00][         IntegrityValidation()] Starting Function
[08/16/2017 17:31:09][         IntegrityValidation()] Calling Function AR_InvoiceCreation() TransID 11JKC010817213010101
[08/16/2017 17:31:52][     MarketingDocuments_Sync()] Starting Function 
[08/16/2017 17:32:02][     MarketingDocuments_Sync()] Calling Funcion AR_InvoiceCreation() : AR Invoice DocEntry 
[08/16/2017 17:32:49][          AR_InvoiceCreation()] Starting Function 
